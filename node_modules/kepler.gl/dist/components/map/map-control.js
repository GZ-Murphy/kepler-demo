"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf3 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _taggedTemplateLiteral2 = _interopRequireDefault(require("@babel/runtime/helpers/taggedTemplateLiteral"));

var _react = _interopRequireWildcard(require("react"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _reselect = require("reselect");

var _styledComponents = _interopRequireDefault(require("styled-components"));

var _styledComponents2 = require("../common/styled-components");

var _mapLayerSelector = _interopRequireDefault(require("../common/map-layer-selector"));

var _logo = _interopRequireDefault(require("../common/logo"));

var _mapLegend = _interopRequireDefault(require("./map-legend"));

var _icons = require("../common/icons");

function _templateObject5() {
  var data = (0, _taggedTemplateLiteral2["default"])(["\n  display: flex;\n  justify-content: space-between;\n  background-color: ", ";\n  height: 32px;\n  padding: 6px 12px;\n  font-size: 11px;\n  color: ", ";\n\n  button {\n    width: 18px;\n    height: 18px;\n  }\n"]);

  _templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function _templateObject4() {
  var data = (0, _taggedTemplateLiteral2["default"])(["\n  ", " max-height: 500px;\n  min-height: 100px;\n  overflow: auto;\n"]);

  _templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function _templateObject3() {
  var data = (0, _taggedTemplateLiteral2["default"])(["\n  background-color: ", ";\n  flex-grow: 1;\n  z-index: 1;\n  p {\n    margin-bottom: 0;\n  }\n"]);

  _templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function _templateObject2() {
  var data = (0, _taggedTemplateLiteral2["default"])(["\n  padding: 4px 0;\n  display: flex;\n  justify-content: flex-end;\n"]);

  _templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function _templateObject() {
  var data = (0, _taggedTemplateLiteral2["default"])(["\n  right: 0;\n  width: ", "px;\n  padding: ", "px;\n  z-index: 1;\n  top: ", "px;\n  position: absolute;\n"]);

  _templateObject = function _templateObject() {
    return data;
  };

  return data;
}

var StyledMapControl = _styledComponents["default"].div(_templateObject(), function (props) {
  return props.theme.mapControl.width;
}, function (props) {
  return props.theme.mapControl.padding;
}, function (props) {
  return props.top;
});

var StyledMapControlAction = _styledComponents["default"].div(_templateObject2());

var StyledMapControlPanel = _styledComponents["default"].div(_templateObject3(), function (props) {
  return props.theme.mapPanelBackgroundColor;
});

var StyledMapControlPanelContent = _styledComponents["default"].div(_templateObject4(), function (props) {
  return props.theme.dropdownScrollBar;
});

var StyledMapControlPanelHeader = _styledComponents["default"].div(_templateObject5(), function (props) {
  return props.theme.mapPanelHeaderBackgroundColor;
}, function (props) {
  return props.theme.titleTextColor;
});

var ActionPanel = function ActionPanel(_ref) {
  var children = _ref.children;
  return _react["default"].createElement(StyledMapControlAction, null, children);
};

var MapLegendTooltip = function MapLegendTooltip(_ref2) {
  var id = _ref2.id,
      message = _ref2.message;
  return _react["default"].createElement(_styledComponents2.Tooltip, {
    id: id,
    place: "left",
    effect: "solid"
  }, _react["default"].createElement("span", null, message));
};

var LayerSelectorPanel = function LayerSelectorPanel(_ref3) {
  var items = _ref3.items,
      onMapToggleLayer = _ref3.onMapToggleLayer,
      isActive = _ref3.isActive,
      toggleMenuPanel = _ref3.toggleMenuPanel;
  return !isActive ? _react["default"].createElement(_styledComponents2.MapControlButton, {
    key: 1,
    onClick: function onClick(e) {
      e.preventDefault();
      toggleMenuPanel();
    },
    className: "map-control-button toggle-layer",
    "data-tip": true,
    "data-for": "toggle-layer"
  }, _react["default"].createElement(_icons.Layers, {
    height: "22px"
  }), _react["default"].createElement(MapLegendTooltip, {
    id: "toggle-layer",
    message: isActive ? 'Hide layer panel' : 'Show layer panel'
  })) : _react["default"].createElement(MapControlPanel, {
    header: "Visible layers",
    onClick: toggleMenuPanel
  }, _react["default"].createElement(_mapLayerSelector["default"], {
    layers: items,
    onMapToggleLayer: onMapToggleLayer
  }));
};

var MapControlPanel = function MapControlPanel(_ref4) {
  var children = _ref4.children,
      header = _ref4.header,
      onClick = _ref4.onClick,
      _ref4$scale = _ref4.scale,
      scale = _ref4$scale === void 0 ? 1 : _ref4$scale,
      isExport = _ref4.isExport;
  return _react["default"].createElement(StyledMapControlPanel, {
    style: {
      transform: "scale(".concat(scale, ") translate(calc(-").concat(25 * (scale - 1), "% - ").concat(10 * scale, "px), calc(").concat(25 * (scale - 1), "% + ").concat(10 * scale, "px))")
    }
  }, _react["default"].createElement(StyledMapControlPanelHeader, {
    style: {
      position: 'relative'
    }
  }, isExport ? _react["default"].createElement(_logo["default"], {
    version: false,
    appName: "kepler.gl"
  }) : _react["default"].createElement("span", {
    style: {
      verticalAlign: 'middle'
    }
  }, header), isExport ? null : _react["default"].createElement(_styledComponents2.IconRoundSmall, null, _react["default"].createElement(_icons.Close, {
    height: "16px",
    onClick: onClick
  }))), _react["default"].createElement(StyledMapControlPanelContent, null, children));
};

var MapLegendPanel = function MapLegendPanel(_ref5) {
  var layers = _ref5.layers,
      isActive = _ref5.isActive,
      scale = _ref5.scale,
      toggleMenuPanel = _ref5.toggleMenuPanel,
      isExport = _ref5.isExport;
  return !isActive ? _react["default"].createElement(_styledComponents2.MapControlButton, {
    key: 2,
    "data-tip": true,
    "data-for": "show-legend",
    className: "map-control-button show-legend",
    onClick: function onClick(e) {
      e.preventDefault();
      toggleMenuPanel();
    }
  }, _react["default"].createElement(_icons.Legend, {
    height: "22px"
  }), _react["default"].createElement(MapLegendTooltip, {
    id: "show-legend",
    message: 'show legend'
  })) : _react["default"].createElement(MapControlPanel, {
    scale: scale,
    header: 'Layer Legend',
    onClick: toggleMenuPanel,
    isExport: isExport
  }, _react["default"].createElement(_mapLegend["default"], {
    layers: layers
  }));
};

var MapControlFactory = function MapControlFactory() {
  var MapControl =
  /*#__PURE__*/
  function (_Component) {
    (0, _inherits2["default"])(MapControl, _Component);

    function MapControl() {
      var _getPrototypeOf2;

      var _this;

      (0, _classCallCheck2["default"])(this, MapControl);

      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }

      _this = (0, _possibleConstructorReturn2["default"])(this, (_getPrototypeOf2 = (0, _getPrototypeOf3["default"])(MapControl)).call.apply(_getPrototypeOf2, [this].concat(args)));
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "layerSelector", function (props) {
        return props.layers;
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "layersToRenderSelector", function (props) {
        return props.layersToRender;
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "layerPanelItemsSelector", (0, _reselect.createSelector)(_this.layerSelector, _this.layersToRenderSelector, function (layers, layersToRender) {
        return layers.filter(function (l) {
          return l.config.isVisible;
        }).map(function (layer) {
          return {
            id: layer.id,
            name: layer.config.label,
            // layer
            isVisible: layersToRender[layer.id]
          };
        });
      }));
      return _this;
    }

    (0, _createClass2["default"])(MapControl, [{
      key: "render",
      value: function render() {
        var _this$props = this.props,
            dragRotate = _this$props.dragRotate,
            layers = _this$props.layers,
            layersToRender = _this$props.layersToRender,
            isSplit = _this$props.isSplit,
            isExport = _this$props.isExport,
            mapIndex = _this$props.mapIndex,
            mapControls = _this$props.mapControls,
            onTogglePerspective = _this$props.onTogglePerspective,
            onToggleSplitMap = _this$props.onToggleSplitMap,
            onMapToggleLayer = _this$props.onMapToggleLayer,
            onToggleMapControl = _this$props.onToggleMapControl,
            scale = _this$props.scale,
            readOnly = _this$props.readOnly;
        var _mapControls$visibleL = mapControls.visibleLayers,
            visibleLayers = _mapControls$visibleL === void 0 ? {} : _mapControls$visibleL,
            _mapControls$mapLegen = mapControls.mapLegend,
            mapLegend = _mapControls$mapLegen === void 0 ? {} : _mapControls$mapLegen,
            _mapControls$toggle3d = mapControls.toggle3d,
            toggle3d = _mapControls$toggle3d === void 0 ? {} : _mapControls$toggle3d,
            _mapControls$splitMap = mapControls.splitMap,
            splitMap = _mapControls$splitMap === void 0 ? {} : _mapControls$splitMap;
        return _react["default"].createElement(StyledMapControl, {
          className: "map-control"
        }, splitMap.show && readOnly !== true ? _react["default"].createElement(ActionPanel, {
          key: 0
        }, _react["default"].createElement(_styledComponents2.MapControlButton, {
          active: isSplit,
          onClick: function onClick(e) {
            e.preventDefault();
            onToggleSplitMap(isSplit ? mapIndex : undefined);
          },
          key: "split-".concat(isSplit),
          className: "map-control-button split-map",
          "data-tip": true,
          "data-for": "action-toggle"
        }, isSplit ? _react["default"].createElement(_icons.Delete, {
          height: "18px"
        }) : _react["default"].createElement(_icons.Split, {
          height: "18px"
        }), _react["default"].createElement(MapLegendTooltip, {
          id: "action-toggle",
          message: isSplit ? 'Close current panel' : 'Switch to dual map view'
        }))) : null, isSplit && visibleLayers.show && readOnly !== true ? _react["default"].createElement(ActionPanel, {
          key: 1
        }, _react["default"].createElement(LayerSelectorPanel, {
          items: this.layerPanelItemsSelector(this.props),
          onMapToggleLayer: onMapToggleLayer,
          isActive: visibleLayers.active,
          toggleMenuPanel: function toggleMenuPanel() {
            return onToggleMapControl('visibleLayers');
          }
        })) : null, toggle3d.show ? _react["default"].createElement(ActionPanel, {
          key: 2
        }, _react["default"].createElement(_styledComponents2.MapControlButton, {
          onClick: function onClick(e) {
            e.preventDefault();
            onTogglePerspective();
          },
          active: dragRotate,
          "data-tip": true,
          "data-for": "action-3d"
        }, _react["default"].createElement(_icons.Cube3d, {
          height: "22px"
        }), _react["default"].createElement(MapLegendTooltip, {
          id: "action-3d",
          message: dragRotate ? 'Disable 3D Map' : '3D Map'
        }))) : null, mapLegend.show ? _react["default"].createElement(ActionPanel, {
          key: 3
        }, _react["default"].createElement(MapLegendPanel, {
          layers: layers.filter(function (l) {
            return layersToRender[l.id];
          }),
          scale: scale,
          isExport: isExport,
          onMapToggleLayer: onMapToggleLayer,
          isActive: mapLegend.active,
          toggleMenuPanel: function toggleMenuPanel() {
            return onToggleMapControl('mapLegend');
          }
        })) : null);
      }
    }]);
    return MapControl;
  }(_react.Component);

  (0, _defineProperty2["default"])(MapControl, "propTypes", {
    datasets: _propTypes["default"].object.isRequired,
    dragRotate: _propTypes["default"].bool.isRequired,
    isSplit: _propTypes["default"].bool.isRequired,
    layers: _propTypes["default"].arrayOf(_propTypes["default"].object),
    layersToRender: _propTypes["default"].object.isRequired,
    mapIndex: _propTypes["default"].number.isRequired,
    mapControls: _propTypes["default"].object.isRequired,
    onTogglePerspective: _propTypes["default"].func.isRequired,
    onToggleSplitMap: _propTypes["default"].func.isRequired,
    onToggleMapControl: _propTypes["default"].func.isRequired,
    onMapToggleLayer: _propTypes["default"].func.isRequired,
    top: _propTypes["default"].number.isRequired,
    // optional
    readOnly: _propTypes["default"].bool,
    scale: _propTypes["default"].number
  });
  (0, _defineProperty2["default"])(MapControl, "defaultProps", {
    isSplit: false,
    top: 0
  });
  return MapControl;
};

var _default = MapControlFactory;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21wb25lbnRzL21hcC9tYXAtY29udHJvbC5qcyJdLCJuYW1lcyI6WyJTdHlsZWRNYXBDb250cm9sIiwic3R5bGVkIiwiZGl2IiwicHJvcHMiLCJ0aGVtZSIsIm1hcENvbnRyb2wiLCJ3aWR0aCIsInBhZGRpbmciLCJ0b3AiLCJTdHlsZWRNYXBDb250cm9sQWN0aW9uIiwiU3R5bGVkTWFwQ29udHJvbFBhbmVsIiwibWFwUGFuZWxCYWNrZ3JvdW5kQ29sb3IiLCJTdHlsZWRNYXBDb250cm9sUGFuZWxDb250ZW50IiwiZHJvcGRvd25TY3JvbGxCYXIiLCJTdHlsZWRNYXBDb250cm9sUGFuZWxIZWFkZXIiLCJtYXBQYW5lbEhlYWRlckJhY2tncm91bmRDb2xvciIsInRpdGxlVGV4dENvbG9yIiwiQWN0aW9uUGFuZWwiLCJjaGlsZHJlbiIsIk1hcExlZ2VuZFRvb2x0aXAiLCJpZCIsIm1lc3NhZ2UiLCJMYXllclNlbGVjdG9yUGFuZWwiLCJpdGVtcyIsIm9uTWFwVG9nZ2xlTGF5ZXIiLCJpc0FjdGl2ZSIsInRvZ2dsZU1lbnVQYW5lbCIsImUiLCJwcmV2ZW50RGVmYXVsdCIsIk1hcENvbnRyb2xQYW5lbCIsImhlYWRlciIsIm9uQ2xpY2siLCJzY2FsZSIsImlzRXhwb3J0IiwidHJhbnNmb3JtIiwicG9zaXRpb24iLCJ2ZXJ0aWNhbEFsaWduIiwiTWFwTGVnZW5kUGFuZWwiLCJsYXllcnMiLCJNYXBDb250cm9sRmFjdG9yeSIsIk1hcENvbnRyb2wiLCJsYXllcnNUb1JlbmRlciIsImxheWVyU2VsZWN0b3IiLCJsYXllcnNUb1JlbmRlclNlbGVjdG9yIiwiZmlsdGVyIiwibCIsImNvbmZpZyIsImlzVmlzaWJsZSIsIm1hcCIsImxheWVyIiwibmFtZSIsImxhYmVsIiwiZHJhZ1JvdGF0ZSIsImlzU3BsaXQiLCJtYXBJbmRleCIsIm1hcENvbnRyb2xzIiwib25Ub2dnbGVQZXJzcGVjdGl2ZSIsIm9uVG9nZ2xlU3BsaXRNYXAiLCJvblRvZ2dsZU1hcENvbnRyb2wiLCJyZWFkT25seSIsInZpc2libGVMYXllcnMiLCJtYXBMZWdlbmQiLCJ0b2dnbGUzZCIsInNwbGl0TWFwIiwic2hvdyIsInVuZGVmaW5lZCIsImxheWVyUGFuZWxJdGVtc1NlbGVjdG9yIiwiYWN0aXZlIiwiQ29tcG9uZW50IiwiZGF0YXNldHMiLCJQcm9wVHlwZXMiLCJvYmplY3QiLCJpc1JlcXVpcmVkIiwiYm9vbCIsImFycmF5T2YiLCJudW1iZXIiLCJmdW5jIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFvQkE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFTQSxJQUFNQSxnQkFBZ0IsR0FBR0MsNkJBQU9DLEdBQVYsb0JBRVgsVUFBQUMsS0FBSztBQUFBLFNBQUlBLEtBQUssQ0FBQ0MsS0FBTixDQUFZQyxVQUFaLENBQXVCQyxLQUEzQjtBQUFBLENBRk0sRUFHVCxVQUFBSCxLQUFLO0FBQUEsU0FBSUEsS0FBSyxDQUFDQyxLQUFOLENBQVlDLFVBQVosQ0FBdUJFLE9BQTNCO0FBQUEsQ0FISSxFQUtiLFVBQUFKLEtBQUs7QUFBQSxTQUFJQSxLQUFLLENBQUNLLEdBQVY7QUFBQSxDQUxRLENBQXRCOztBQVNBLElBQU1DLHNCQUFzQixHQUFHUiw2QkFBT0MsR0FBVixvQkFBNUI7O0FBTUEsSUFBTVEscUJBQXFCLEdBQUdULDZCQUFPQyxHQUFWLHFCQUNMLFVBQUFDLEtBQUs7QUFBQSxTQUFJQSxLQUFLLENBQUNDLEtBQU4sQ0FBWU8sdUJBQWhCO0FBQUEsQ0FEQSxDQUEzQjs7QUFTQSxJQUFNQyw0QkFBNEIsR0FBR1gsNkJBQU9DLEdBQVYscUJBQzlCLFVBQUFDLEtBQUs7QUFBQSxTQUFJQSxLQUFLLENBQUNDLEtBQU4sQ0FBWVMsaUJBQWhCO0FBQUEsQ0FEeUIsQ0FBbEM7O0FBTUEsSUFBTUMsMkJBQTJCLEdB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VGhCO0FBVWpCZCxJQUFBQSxrQkFBa0IsRUFBRVksc0JBQVVNLElBQVYsQ0FBZUosVUFWbEI7QUFXakJoRCxJQUFBQSxnQkFBZ0IsRUFBRThDLHNCQUFVTSxJQUFWLENBQWVKLFVBWGhCO0FBWWpCaEUsSUFBQUEsR0FBRyxFQUFFOEQsc0JBQVVLLE1BQVYsQ0FBaUJILFVBWkw7QUFjakI7QUFDQWIsSUFBQUEsUUFBUSxFQUFFVyxzQkFBVUcsSUFmSDtBQWdCakJ6QyxJQUFBQSxLQUFLLEVBQUVzQyxzQkFBVUs7QUFoQkEsR0FGUztBQUFBLG1DQUN4Qm5DLFVBRHdCLGtCQXFCTjtBQUNwQmEsSUFBQUEsT0FBTyxFQUFFLEtBRFc7QUFFcEI3QyxJQUFBQSxHQUFHLEVBQUU7QUFGZSxHQXJCTTtBQWtKOUIsU0FBT2dDLFVBQVA7QUFDRCxDQW5KRDs7ZUFxSmVELGlCIiwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IChjKSAyMDE5IFViZXIgVGVjaG5vbG9naWVzLCBJbmMuXG4vL1xuLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuLy8gb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuLy8gaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuLy8gdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuLy8gY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4vLyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4vLyBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbi8vXG4vLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4vLyBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbi8vIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuLy8gQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuLy8gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbi8vIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbi8vIFRIRSBTT0ZUV0FSRS5cblxuaW1wb3J0IFJlYWN0LCB7Q29tcG9uZW50fSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IHtjcmVhdGVTZWxlY3Rvcn0gZnJvbSAncmVzZWxlY3QnO1xuaW1wb3J0IHN0eWxlZCBmcm9tICdzdHlsZWQtY29tcG9uZW50cyc7XG5cbmltcG9ydCB7VG9vbHRpcCwgSWNvblJvdW5kU21hbGwsIE1hcENvbnRyb2xCdXR0b259IGZyb20gJ2NvbXBvbmVudHMvY29tbW9uL3N0eWxlZC1jb21wb25lbnRzJztcbmltcG9ydCBNYXBMYXllclNlbGVjdG9yIGZyb20gJ2NvbXBvbmVudHMvY29tbW9uL21hcC1sYXllci1zZWxlY3Rvcic7XG5pbXBvcnQgS2VwbGVyR2xMb2dvIGZyb20gJ2NvbXBvbmVudHMvY29tbW9uL2xvZ28nO1xuaW1wb3J0IE1hcExlZ2VuZCBmcm9tICcuL21hcC1sZWdlbmQnO1xuaW1wb3J0IHtcbiAgQ2xvc2UsXG4gIFNwbGl0LFxuICBMZWdlbmQsXG4gIEN1YmUzZCxcbiAgRGVsZXRlLFxuICBMYXllcnNcbn0gZnJvbSAnY29tcG9uZW50cy9jb21tb24vaWNvbnMnO1xuXG5jb25zdCBTdHlsZWRNYXBDb250cm9sID0gc3R5bGVkLmRpdmBcbiAgcmlnaHQ6IDA7XG4gIHdpZHRoOiAke3Byb3BzID0+IHByb3BzLnRoZW1lLm1hcENvbnRyb2wud2lkdGh9cHg7XG4gIHBhZGRpbmc6ICR7cHJvcHMgPT4gcHJvcHMudGhlbWUubWFwQ29udHJvbC5wYWRkaW5nfXB4O1xuICB6LWluZGV4OiAxO1xuICB0b3A6ICR7cHJvcHMgPT4gcHJvcHMudG9wfXB4O1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG5gO1xuXG5jb25zdCBTdHlsZWRNYXBDb250cm9sQWN0aW9uID0gc3R5bGVkLmRpdmBcbiAgcGFkZGluZzogNHB4IDA7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGp1c3RpZnktY29udGVudDogZmxleC1lbmQ7XG5gO1xuXG5jb25zdCBTdHlsZWRNYXBDb250cm9sUGFuZWwgPSBzdHlsZWQuZGl2YFxuICBiYWNrZ3JvdW5kLWNvbG9yOiAke3Byb3BzID0+IHByb3BzLnRoZW1lLm1hcFBhbmVsQmFja2dyb3VuZENvbG9yfTtcbiAgZmxleC1ncm93OiAxO1xuICB6LWluZGV4OiAxO1xuICBwIHtcbiAgICBtYXJnaW4tYm90dG9tOiAwO1xuICB9XG5gO1xuXG5jb25zdCBTdHlsZWRNYXBDb250cm9sUGFuZWxDb250ZW50ID0gc3R5bGVkLmRpdmBcbiAgJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5kcm9wZG93blNjcm9sbEJhcn0gbWF4LWhlaWdodDogNTAwcHg7XG4gIG1pbi1oZWlnaHQ6IDEwMHB4O1xuICBvdmVyZmxvdzogYXV0bztcbmA7XG5cbmNvbnN0IFN0eWxlZE1hcENvbnRyb2xQYW5lbEhlYWRlciA9IHN0eWxlZC5kaXZgXG4gIGRpc3BsYXk6IGZsZXg7XG4gIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcbiAgYmFja2dyb3VuZC1jb2xvcjogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5tYXBQYW5lbEhlYWRlckJhY2tncm91bmRDb2xvcn07XG4gIGhlaWdodDogMzJweDtcbiAgcGFkZGluZzogNnB4IDEycHg7XG4gIGZvbnQtc2l6ZTogMTFweDtcbiAgY29sb3I6ICR7cHJvcHMgPT4gcHJvcHMudGhlbWUudGl0bGVUZXh0Q29sb3J9O1xuXG4gIGJ1dHRvbiB7XG4gICAgd2lkdGg6IDE4cHg7XG4gICAgaGVpZ2h0OiAxOHB4O1xuICB9XG5gO1xuXG5jb25zdCBBY3Rpb25QYW5lbCA9ICh7Y2hpbGRyZW59KSA9PiAoXG4gIDxTdHlsZWRNYXBDb250cm9sQWN0aW9uPntjaGlsZHJlbn08L1N0eWxlZE1hcENvbnRyb2xBY3Rpb24+XG4pO1xuXG5jb25zdCBNYXBMZWdlbmRUb29sdGlwID0gKHtpZCwgbWVzc2FnZX0pID0+IChcbiAgPFRvb2x0aXAgaWQ9e2lkfSBwbGFjZT1cImxlZnRcIiBlZmZlY3Q9XCJzb2xpZFwiPlxuICAgIDxzcGFuPnttZXNzYWdlfTwvc3Bhbj5cbiAgPC9Ub29sdGlwPlxuKTtcblxuY29uc3QgTGF5ZXJTZWxlY3RvclBhbmVsID0gKHtcbiAgaXRlbXMsXG4gIG9uTWFwVG9nZ2xlTGF5ZXIsXG4gIGlzQWN0aXZlLFxuICB0b2dnbGVNZW51UGFuZWxcbn0pID0+XG4gICFpc0FjdGl2ZSA/IChcbiAgICA8TWFwQ29udHJvbEJ1dHRvblxuICAgICAga2V5PXsxfVxuICAgICAgb25DbGljaz17ZSA9PiB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdG9nZ2xlTWVudVBhbmVsKCk7XG4gICAgICB9fVxuICAgICAgY2xhc3NOYW1lPVwibWFwLWNvbnRyb2wtYnV0dG9uIHRvZ2dsZS1sYXllclwiXG4gICAgICBkYXRhLXRpcFxuICAgICAgZGF0YS1mb3I9XCJ0b2dnbGUtbGF5ZXJcIlxuICAgID5cbiAgICAgIDxMYXllcnMgaGVpZ2h0PVwiMjJweFwiIC8+XG4gICAgICA8TWFwTGVnZW5kVG9vbHRpcFxuICAgICAgICBpZD1cInRvZ2dsZS1sYXllclwiXG4gICAgICAgIG1lc3NhZ2U9e2lzQWN0aXZlID8gJ0hpZGUgbGF5ZXIgcGFuZWwnIDogJ1Nob3cgbGF5ZXIgcGFuZWwnfVxuICAgICAgLz5cbiAgICA8L01hcENvbnRyb2xCdXR0b24+XG4gICkgOiAoXG4gICAgPE1hcENvbnRyb2xQYW5lbCBoZWFkZXI9XCJWaXNpYmxlIGxheWVyc1wiIG9uQ2xpY2s9e3RvZ2dsZU1lbnVQYW5lbH0+XG4gICAgICA8TWFwTGF5ZXJTZWxlY3RvciBsYXllcnM9e2l0ZW1zfSBvbk1hcFRvZ2dsZUxheWVyPXtvbk1hcFRvZ2dsZUxheWVyfSAvPlxuICAgIDwvTWFwQ29udHJvbFBhbmVsPlxuICApO1xuXG5jb25zdCBNYXBDb250cm9sUGFuZWwgPSAoe2NoaWxkcmVuLCBoZWFkZXIsIG9uQ2xpY2ssIHNjYWxlID0gMSwgaXNFeHBvcnR9KSA9PiAoXG4gIDxTdHlsZWRNYXBDb250cm9sUGFuZWxcbiAgICBzdHlsZT17e1xuICAgICAgdHJhbnNmb3JtOiBgc2NhbGUoJHtzY2FsZX0pIHRyYW5zbGF0ZShjYWxjKC0kezI1ICogKHNjYWxlIC0gMSl9JSAtICR7MTAgKlxuICAgICAgICBzY2FsZX1weCksIGNhbGMoJHsyNSAqIChzY2FsZSAtIDEpfSUgKyAkezEwICogc2NhbGV9cHgpKWBcbiAgICB9fVxuICA+XG4gICAgPFN0eWxlZE1hcENvbnRyb2xQYW5lbEhlYWRlciBzdHlsZT17e3Bvc2l0aW9uOiAncmVsYXRpdmUnfX0+XG4gICAgICB7aXNFeHBvcnQgPyAoXG4gICAgICAgIDxLZXBsZXJHbExvZ28gdmVyc2lvbj17ZmFsc2V9IGFwcE5hbWU9XCJrZXBsZXIuZ2xcIiAvPlxuICAgICAgKSA6IChcbiAgICAgICAgPHNwYW4gc3R5bGU9e3t2ZXJ0aWNhbEFsaWduOiAnbWlkZGxlJ319PntoZWFkZXJ9PC9zcGFuPlxuICAgICAgKX1cbiAgICAgIHtpc0V4cG9ydCA/IG51bGwgOiAoXG4gICAgICAgIDxJY29uUm91bmRTbWFsbD5cbiAgICAgICAgICA8Q2xvc2UgaGVpZ2h0PVwiMTZweFwiIG9uQ2xpY2s9e29uQ2xpY2t9IC8+XG4gICAgICAgIDwvSWNvblJvdW5kU21hbGw+XG4gICAgICApfVxuICAgIDwvU3R5bGVkTWFwQ29udHJvbFBhbmVsSGVhZGVyPlxuICAgIDxTdHlsZWRNYXBDb250cm9sUGFuZWxDb250ZW50PntjaGlsZHJlbn08L1N0eWxlZE1hcENvbnRyb2xQYW5lbENvbnRlbnQ+XG4gIDwvU3R5bGVkTWFwQ29udHJvbFBhbmVsPlxuKTtcblxuY29uc3QgTWFwTGVnZW5kUGFuZWwgPSAoe2xheWVycywgaXNBY3RpdmUsIHNjYWxlLCB0b2dnbGVNZW51UGFuZWwsIGlzRXhwb3J0fSkgPT5cbiAgIWlzQWN0aXZlID8gKFxuICAgIDxNYXBDb250cm9sQnV0dG9uXG4gICAgICBrZXk9ezJ9XG4gICAgICBkYXRhLXRpcFxuICAgICAgZGF0YS1mb3I9XCJzaG93LWxlZ2VuZFwiXG4gICAgICBjbGFzc05hbWU9XCJtYXAtY29udHJvbC1idXR0b24gc2hvdy1sZWdlbmRcIlxuICAgICAgb25DbGljaz17ZSA9PiB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdG9nZ2xlTWVudVBhbmVsKCk7XG4gICAgICB9fVxuICAgID5cbiAgICAgIDxMZWdlbmQgaGVpZ2h0PVwiMjJweFwiIC8+XG4gICAgICA8TWFwTGVnZW5kVG9vbHRpcCBpZD1cInNob3ctbGVnZW5kXCIgbWVzc2FnZT17J3Nob3cgbGVnZW5kJ30gLz5cbiAgICA8L01hcENvbnRyb2xCdXR0b24+XG4gICkgOiAoXG4gICAgPE1hcENvbnRyb2xQYW5lbFxuICAgICAgc2NhbGU9e3NjYWxlfVxuICAgICAgaGVhZGVyPXsnTGF5ZXIgTGVnZW5kJ31cbiAgICAgIG9uQ2xpY2s9e3RvZ2dsZU1lbnVQYW5lbH1cbiAgICAgIGlzRXhwb3J0PXtpc0V4cG9ydH1cbiAgICA+XG4gICAgICA8TWFwTGVnZW5kIGxheWVycz17bGF5ZXJzfS8+XG4gICAgPC9NYXBDb250cm9sUGFuZWw+XG4gICk7XG5cbmNvbnN0IE1hcENvbnRyb2xGYWN0b3J5ID0gKCkgPT4ge1xuICBjbGFzcyBNYXBDb250cm9sIGV4dGVuZHMgQ29tcG9uZW50IHtcbiAgICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgICAgZGF0YXNldHM6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgICAgIGRyYWdSb3RhdGU6IFByb3BUeXBlcy5ib29sLmlzUmVxdWlyZWQsXG4gICAgICBpc1NwbGl0OiBQcm9wVHlwZXMuYm9vbC5pc1JlcXVpcmVkLFxuICAgICAgbGF5ZXJzOiBQcm9wVHlwZXMuYXJyYXlPZihQcm9wVHlwZXMub2JqZWN0KSxcbiAgICAgIGxheWVyc1RvUmVuZGVyOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gICAgICBtYXBJbmRleDogUHJvcFR5cGVzLm51bWJlci5pc1JlcXVpcmVkLFxuICAgICAgbWFwQ29udHJvbHM6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgICAgIG9uVG9nZ2xlUGVyc3BlY3RpdmU6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gICAgICBvblRvZ2dsZVNwbGl0TWFwOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICAgICAgb25Ub2dnbGVNYXBDb250cm9sOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICAgICAgb25NYXBUb2dnbGVMYXllcjogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgICAgIHRvcDogUHJvcFR5cGVzLm51bWJlci5pc1JlcXVpcmVkLFxuXG4gICAgICAvLyBvcHRpb25hbFxuICAgICAgcmVhZE9ubHk6IFByb3BUeXBlcy5ib29sLFxuICAgICAgc2NhbGU6IFByb3BUeXBlcy5udW1iZXJcbiAgICB9O1xuXG4gICAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICAgIGlzU3BsaXQ6IGZhbHNlLFxuICAgICAgdG9wOiAwXG4gICAgfTtcblxuICAgIGxheWVyU2VsZWN0b3IgPSBwcm9wcyA9PiBwcm9wcy5sYXllcnM7XG4gICAgbGF5ZXJzVG9SZW5kZXJTZWxlY3RvciA9IHByb3BzID0+IHByb3BzLmxheWVyc1RvUmVuZGVyO1xuICAgIGxheWVyUGFuZWxJdGVtc1NlbGVjdG9yID0gY3JlYXRlU2VsZWN0b3IoXG4gICAgICB0aGlzLmxheWVyU2VsZWN0b3IsXG4gICAgICB0aGlzLmxheWVyc1RvUmVuZGVyU2VsZWN0b3IsXG4gICAgICAobGF5ZXJzLCBsYXllcnNUb1JlbmRlcikgPT5cbiAgICAgICAgIGxheWVyc1xuICAgICAgICAgIC5maWx0ZXIobCA9PiBsLmNvbmZpZy5pc1Zpc2libGUpXG4gICAgICAgICAgLm1hcChsYXllciA9PiAoe1xuICAgICAgICAgICAgaWQ6IGxheWVyLmlkLFxuICAgICAgICAgICAgbmFtZTogbGF5ZXIuY29uZmlnLmxhYmVsLFxuICAgICAgICAgICAgLy8gbGF5ZXJcbiAgICAgICAgICAgIGlzVmlzaWJsZTogbGF5ZXJzVG9SZW5kZXJbbGF5ZXIuaWRdXG4gICAgICAgICAgfSkpXG4gICAgKTtcblxuICAgIHJlbmRlcigpIHtcblxuICAgICAgY29uc3Qge1xuICAgICAgICBkcmFnUm90YXRlLFxuICAgICAgICBsYXllcnMsXG4gICAgICAgIGxheWVyc1RvUmVuZGVyLFxuICAgICAgICBpc1NwbGl0LFxuICAgICAgICBpc0V4cG9ydCxcbiAgICAgICAgbWFwSW5kZXgsXG4gICAgICAgIG1hcENvbnRyb2xzLFxuICAgICAgICBvblRvZ2dsZVBlcnNwZWN0aXZlLFxuICAgICAgICBvblRvZ2dsZVNwbGl0TWFwLFxuICAgICAgICBvbk1hcFRvZ2dsZUxheWVyLFxuICAgICAgICBvblRvZ2dsZU1hcENvbnRyb2wsXG4gICAgICAgIHNjYWxlLFxuICAgICAgICByZWFkT25seVxuICAgICAgfSA9IHRoaXMucHJvcHM7XG5cbiAgICAgIGNvbnN0IHtcbiAgICAgICAgdmlzaWJsZUxheWVycyA9IHt9LFxuICAgICAgICBtYXBMZWdlbmQgPSB7fSxcbiAgICAgICAgdG9nZ2xlM2QgPSB7fSxcbiAgICAgICAgc3BsaXRNYXAgPSB7fVxuICAgICAgfSA9IG1hcENvbnRyb2xzO1xuXG4gICAgICByZXR1cm4gKFxuICAgICAgICA8U3R5bGVkTWFwQ29udHJvbCBjbGFzc05hbWU9XCJtYXAtY29udHJvbFwiPlxuICAgICAgICAgIHsvKiBTcGxpdCBNYXAgKi99XG4gICAgICAgICAge3NwbGl0TWFwLnNob3cgJiYgcmVhZE9ubHkgIT09IHRydWUgPyAoXG4gICAgICAgICAgICA8QWN0aW9uUGFuZWwga2V5PXswfT5cbiAgICAgICAgICAgICAgPE1hcENvbnRyb2xCdXR0b25cbiAgICAgICAgICAgICAgICBhY3RpdmU9e2lzU3BsaXR9XG4gICAgICAgICAgICAgICAgb25DbGljaz17ZSA9PiB7XG4gICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICBvblRvZ2dsZVNwbGl0TWFwKGlzU3BsaXQgPyBtYXBJbmRleCA6IHVuZGVmaW5lZCk7XG4gICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICBrZXk9e2BzcGxpdC0ke2lzU3BsaXR9YH1cbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJtYXAtY29udHJvbC1idXR0b24gc3BsaXQtbWFwXCJcbiAgICAgICAgICAgICAgICBkYXRhLXRpcFxuICAgICAgICAgICAgICAgIGRhdGEtZm9yPVwiYWN0aW9uLXRvZ2dsZVwiXG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICB7aXNTcGxpdCA/IDxEZWxldGUgaGVpZ2h0PVwiMThweFwiIC8+IDogPFNwbGl0IGhlaWdodD1cIjE4cHhcIiAvPn1cbiAgICAgICAgICAgICAgICA8TWFwTGVnZW5kVG9vbHRpcFxuICAgICAgICAgICAgICAgICAgaWQ9XCJhY3Rpb24tdG9nZ2xlXCJcbiAgICAgICAgICAgICAgICAgIG1lc3NhZ2U9e1xuICAgICAgICAgICAgICAgICAgICBpc1NwbGl0ID8gJ0Nsb3NlIGN1cnJlbnQgcGFuZWwnIDogJ1N3aXRjaCB0byBkdWFsIG1hcCB2aWV3J1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDwvTWFwQ29udHJvbEJ1dHRvbj5cbiAgICAgICAgICAgIDwvQWN0aW9uUGFuZWw+XG4gICAgICAgICAgKSA6IG51bGx9XG5cbiAgICAgICAgICB7LyogTWFwIExheWVycyAqL31cbiAgICAgICAgICB7aXNTcGxpdCAmJiB2aXNpYmxlTGF5ZXJzLnNob3cgJiYgcmVhZE9ubHkgIT09IHRydWUgPyAoXG4gICAgICAgICAgICA8QWN0aW9uUGFuZWwga2V5PXsxfT5cbiAgICAgICAgICAgICAgPExheWVyU2VsZWN0b3JQYW5lbFxuICAgICAgICAgICAgICAgIGl0ZW1zPXt0aGlzLmxheWVyUGFuZWxJdGVtc1NlbGVjdG9yKHRoaXMucHJvcHMpfVxuICAgICAgICAgICAgICAgIG9uTWFwVG9nZ2xlTGF5ZXI9e29uTWFwVG9nZ2xlTGF5ZXJ9XG4gICAgICAgICAgICAgICAgaXNBY3RpdmU9e3Zpc2libGVMYXllcnMuYWN0aXZlfVxuICAgICAgICAgICAgICAgIHRvZ2dsZU1lbnVQYW5lbD17KCkgPT4gb25Ub2dnbGVNYXBDb250cm9sKCd2aXNpYmxlTGF5ZXJzJyl9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8L0FjdGlvblBhbmVsPlxuICAgICAgICAgICkgOiBudWxsfVxuXG4gICAgICAgICAgey8qIDNEIE1hcCAqL31cbiAgICAgICAgICB7dG9nZ2xlM2Quc2hvdyA/IChcbiAgICAgICAgICAgIDxBY3Rpb25QYW5lbCBrZXk9ezJ9PlxuICAgICAgICAgICAgICA8TWFwQ29udHJvbEJ1dHRvblxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9e2UgPT4ge1xuICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgb25Ub2dnbGVQZXJzcGVjdGl2ZSgpO1xuICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgYWN0aXZlPXtkcmFnUm90YXRlfVxuICAgICAgICAgICAgICAgIGRhdGEtdGlwXG4gICAgICAgICAgICAgICAgZGF0YS1mb3I9XCJhY3Rpb24tM2RcIlxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPEN1YmUzZCBoZWlnaHQ9XCIyMnB4XCIgLz5cbiAgICAgICAgICAgICAgICB7LyogTm8gaWNvbiBzaW5jZSB3ZSBhcmUgaW5qZWN0aW5nIHRocm91Z2ggY3NzIC50aHJlZUQtbWFwIGNsYXNzKi99XG4gICAgICAgICAgICAgICAgPE1hcExlZ2VuZFRvb2x0aXBcbiAgICAgICAgICAgICAgICAgIGlkPVwiYWN0aW9uLTNkXCJcbiAgICAgICAgICAgICAgICAgIG1lc3NhZ2U9e2RyYWdSb3RhdGUgPyAnRGlzYWJsZSAzRCBNYXAnIDogJzNEIE1hcCd9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPC9NYXBDb250cm9sQnV0dG9uPlxuICAgICAgICAgICAgPC9BY3Rpb25QYW5lbD5cbiAgICAgICAgICApIDogbnVsbH1cblxuICAgICAgICAgIHsvKiBNYXAgTGVnZW5kICovfVxuICAgICAgICAgIHttYXBMZWdlbmQuc2hvdyA/IChcbiAgICAgICAgICAgIDxBY3Rpb25QYW5lbCBrZXk9ezN9PlxuICAgICAgICAgICAgICA8TWFwTGVnZW5kUGFuZWxcbiAgICAgICAgICAgICAgICBsYXllcnM9e2xheWVycy5maWx0ZXIobCA9PiBsYXllcnNUb1JlbmRlcltsLmlkXSl9XG4gICAgICAgICAgICAgICAgc2NhbGU9e3NjYWxlfVxuICAgICAgICAgICAgICAgIGlzRXhwb3J0PXtpc0V4cG9ydH1cbiAgICAgICAgICAgICAgICBvbk1hcFRvZ2dsZUxheWVyPXtvbk1hcFRvZ2dsZUxheWVyfVxuICAgICAgICAgICAgICAgIGlzQWN0aXZlPXttYXBMZWdlbmQuYWN0aXZlfVxuICAgICAgICAgICAgICAgIHRvZ2dsZU1lbnVQYW5lbD17KCkgPT4gb25Ub2dnbGVNYXBDb250cm9sKCdtYXBMZWdlbmQnKX1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDwvQWN0aW9uUGFuZWw+XG4gICAgICAgICAgKSA6IG51bGx9XG4gICAgICAgIDwvU3R5bGVkTWFwQ29udHJvbD5cbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIE1hcENvbnRyb2w7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBNYXBDb250cm9sRmFjdG9yeTtcbiJdfQ==