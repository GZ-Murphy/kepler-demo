"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = MapContainerFactory;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireWildcard(require("react"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _reactMapGl = _interopRequireDefault(require("react-map-gl"));

var _deck = _interopRequireDefault(require("deck.gl"));

var _reselect = require("reselect");

var _viewportMercatorProject = _interopRequireDefault(require("viewport-mercator-project"));

var _mapPopover = _interopRequireDefault(require("./map/map-popover"));

var _mapControl = _interopRequireDefault(require("./map/map-control"));

var _styledComponents = require("./common/styled-components");

var _mapboxUtils = require("../layers/mapbox-utils");

var _baseLayer = require("../layers/base-layer");

var _glUtils = require("../utils/gl-utils");

var _mapboxUtils2 = require("../utils/map-style-utils/mapbox-utils");

var _dBuildingLayer = _interopRequireDefault(require("../deckgl-layers/3d-building-layer/3d-building-layer"));

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { (0, _defineProperty2["default"])(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

var MAP_STYLE = {
  container: {
    display: 'inline-block',
    position: 'relative'
  },
  top: {
    position: 'absolute',
    top: '0px',
    pointerEvents: 'none'
  }
};
var MAPBOXGL_STYLE_UPDATE = 'style.load';
var MAPBOXGL_RENDER = 'render';
var TRANSITION_DURATION = 0;
MapContainerFactory.deps = [_mapPopover["default"], _mapControl["default"]];

function MapContainerFactory(MapPopover, MapControl) {
  var MapContainer =
  /*#__PURE__*/
  function (_Component) {
    (0, _inherits2["default"])(MapContainer, _Component);

    function MapContainer(_props) {
      var _this;

      (0, _classCallCheck2["default"])(this, MapContainer);
      _this = (0, _possibleConstructorReturn2["default"])(this, (0, _getPrototypeOf2["default"])(MapContainer).call(this, _props));
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "layersSelector", function (props) {
        return props.layers;
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "layerDataSelector", function (props) {
        return props.layerData;
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "mapLayersSelector", function (props) {
        return props.mapLayers;
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "layerOrderSelector", function (props) {
        return props.layerOrder;
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "layersToRenderSelector", (0, _reselect.createSelector)(_this.layersSelector, _this.layerDataSelector, _this.mapLayersSelector, // {[id]: true \ false}
      function (layers, layerData, mapLayers) {
        return layers.reduce(function (accu, layer, idx) {
          return _objectSpread({}, accu, (0, _defineProperty2["default"])({}, layer.id, layer.shouldRenderLayer(layerData[idx]) && _this._isVisibleMapLayer(layer, mapLayers)));
        }, {});
      }));
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "mapboxLayersSelector", (0, _reselect.createSelector)(_this.layersSelector, _this.layerDataSelector, _this.layerOrderSelector, _this.layersToRenderSelector, _mapboxUtils.generateMapboxLayers));
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_onCloseMapPopover", function () {
        _this.props.visStateActions.onLayerClick(null);
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_onLayerSetDomain", function (idx, colorDomain) {
        _this.props.visStateActions.layerConfigChange(_this.props.layers[idx], {
          colorDomain: colorDomain
        });
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_onWebGLInitialized", _glUtils.onWebGLInitialized);
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_handleMapToggleLayer", function (layerId) {
        var _this$props = _this.props,
            _this$props$index = _this$props.index,
            mapIndex = _this$props$index === void 0 ? 0 : _this$props$index,
            visStateActions = _this$props.visStateActions;
        visStateActions.toggleLayerForMap(mapIndex, layerId);
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_onMapboxStyleUpdate", function () {
        // force refresh mapboxgl layers
        _this.previousLayers = {};

        _this._updateMapboxLayers();

        if (typeof _this.props.onMapStyleLoaded === 'function') {
          _this.props.onMapStyleLoaded(_this._map);
        }
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_setMapboxMap", function (mapbox) {
        if (!_this._map && mapbox) {
          _this._map = mapbox.getMap(); // i noticed in certain context we don't access the actual map element

          if (!_this._map) {
            return;
          } // bind mapboxgl event listener


          _this._map.on(MAPBOXGL_STYLE_UPDATE, _this._onMapboxStyleUpdate);

          _this._map.on(MAPBOXGL_RENDER, function () {
            if (typeof _this.props.onMapRender === 'function') {
              _this.props.onMapRender(_this._map);
            }
          });
        }

        if (_this.props.getMapboxRef) {
          // The parent component can gain access to our MapboxGlMap by
          // providing this callback. Note that 'mapbox' will be null when the
          // ref is unset (e.g. when a split map is closed).
          _this.props.getMapboxRef(mapbox, _this.props.index);
        }
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_onBeforeRender", function (_ref) {
        var gl = _ref.gl;
        (0, _glUtils.setLayerBlending)(gl, _this.props.layerBlending);
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_renderLayer", function (overlays, idx) {
        var _this$props2 = _this.props,
            layers = _this$props2.layers,
            layerData = _this$props2.layerData,
            hoverInfo = _this$props2.hoverInfo,
            clicked = _this$props2.clicked,
            mapState = _this$props2.mapState,
            interactionConfig = _this$props2.interactionConfig,
            mousePos = _this$props2.mousePos,
            animationConfig = _this$props2.animationConfig;
        var layer = layers[idx];
        var data = layerData[idx];
        var layerInteraction = {
          mousePosition: mousePos.mousePosition,
          wrapLongitude: true
        };
        var objectHovered = clicked || hoverInfo;
        var layerCallbacks = {
          onSetLayerDomain: function onSetLayerDomain(val) {
            return _this._onLayerSetDomain(idx, val);
          }
        }; // Layer is Layer class

        var layerOverlay = layer.renderLayer({
          data: data,
          idx: idx,
          layerInteraction: layerInteraction,
          objectHovered: objectHovered,
          mapState: mapState,
          interactionConfig: interactionConfig,
          layerCallbacks: layerCallbacks,
          animationConfig: animationConfig
        });
        return overlays.concat(layerOverlay || []);
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_onViewportChange", function (viewState) {
        if (typeof _this.props.onViewStateChange === 'function') {
          _this.props.onViewStateChange(viewState);
        }

        _this.props.mapStateActions.updateMap(viewState);
      });
      _this.previousLayers = {// [layers.id]: mapboxLayerConfig
      };
      return _this;
    }

    (0, _createClass2["default"])(MapContainer, [{
      key: "componentWillUnmount",
      value: function componentWillUnmount() {
        // unbind mapboxgl event listener
        if (this._map) {
          this._map.off(MAPBOXGL_STYLE_UPDATE);

          this._map.off(MAPBOXGL_RENDER);
        }
      }
    }, {
      key: "_isVisibleMapLayer",
      value: function _isVisibleMapLayer(layer, mapLayers) {
        // if layer.id is not in mapLayers, don't render it
        return !mapLayers || mapLayers && mapLayers[layer.id];
      }
    }, {
      key: "_renderMapPopover",

      /* component render functions */

      /* eslint-disable complexity */
      value: function _renderMapPopover(layersToRender) {
        // TODO: move this into reducer so it can be tested
        var _this$props3 = this.props,
            mapState = _this$props3.mapState,
            hoverInfo = _this$props3.hoverInfo,
            clicked = _this$props3.clicked,
            datasets = _this$props3.datasets,
            interactionConfig = _this$props3.interactionConfig,
            layers = _this$props3.layers,
            _this$props3$mousePos = _this$props3.mousePos,
            mousePosition = _this$props3$mousePos.mousePosition,
            coordinate = _this$props3$mousePos.coordinate,
            pinned = _this$props3$mousePos.pinned;

        if (!mousePosition) {
          return null;
        } // if clicked something, ignore hover behavior


        var objectInfo = clicked || hoverInfo;
        var layerHoverProp = null;
        var position = {
          x: mousePosition[0],
          y: mousePosition[1]
        };

        if (interactionConfig.tooltip.enabled && objectInfo && objectInfo.picked) {
          // if anything hovered
          var object = objectInfo.object,
              overlay = objectInfo.layer; // deckgl layer to kepler-gl layer

          var layer = layers[overlay.props.idx];

          if (layer.getHoverData && layersToRender[layer.id]) {
            // if layer is visible and have hovered data
            var dataId = layer.config.dataId;
            var _datasets$dataId = datasets[dataId],
                allData = _datasets$dataId.allData,
                fields = _datasets$dataId.fields;
            var data = layer.getHoverData(object, allData);
            var fieldsToShow = interactionConfig.tooltip.config.fieldsToShow[dataId];
            layerHoverProp = {
              data: data,
              fields: fields,
              fieldsToShow: fieldsToShow,
              layer: layer
            };
          }
        }

        if (pinned || clicked) {
          // project lnglat to screen so that tooltip follows the object on zoom
          var viewport = new _viewportMercatorProject["default"](mapState);
          var lngLat = clicked ? clicked.lngLat : pinned.coordinate;
          position = this._getHoverXY(viewport, lngLat);
        }

        return _react["default"].createElement("div", null, _react["default"].createElement(MapPopover, (0, _extends2["default"])({}, position, {
          layerHoverProp: layerHoverProp,
          coordinate: interactionConfig.coordinate.enabled && ((pinned || {}).coordinate || coordinate),
          freezed: Boolean(clicked || pinned),
          onClose: this._onCloseMapPopover,
          mapW: mapState.width,
          mapH: mapState.height
        })));
      }
      /* eslint-enable complexity */

    }, {
      key: "_getHoverXY",
      value: function _getHoverXY(viewport, lngLat) {
        var screenCoord = !viewport || !lngLat ? null : viewport.project(lngLat);
        return screenCoord && {
          x: screenCoord[0],
          y: screenCoord[1]
        };
      }
    }, {
      key: "_renderDeckOverlay",
      value: function _renderDeckOverlay(layersToRender) {
        var _this$props4 = this.props,
            mapState = _this$props4.mapState,
            mapStyle = _this$props4.mapStyle,
            layerData = _this$props4.layerData,
            layerOrder = _this$props4.layerOrder,
            layers = _this$props4.layers,
            visStateActions = _this$props4.visStateActions,
            mapboxApiAccessToken = _this$props4.mapboxApiAccessToken,
            mapboxApiUrl = _this$props4.mapboxApiUrl;
        var deckGlLayers = []; // wait until data is ready before render data layers

        if (layerData && layerData.length) {
          // last layer render first
          deckGlLayers = layerOrder.slice().reverse().filter(function (idx) {
            return layers[idx].overlayType === _baseLayer.OVERLAY_TYPE.deckgl && layersToRender[layers[idx].id];
          }).reduce(this._renderLayer, []);
        }

        if (mapStyle.visibleLayerGroups['3d building']) {
          deckGlLayers.push(new _dBuildingLayer["default"]({
            id: '_keplergl_3d-building',
            mapboxApiAccessToken: mapboxApiAccessToken,
            mapboxApiUrl: mapboxApiUrl,
            threeDBuildingColor: mapStyle.threeDBuildingColor,
            updateTriggers: {
              getFillColor: mapStyle.threeDBuildingColor
            }
          }));
        }

        return _react["default"].createElement(_deck["default"], (0, _extends2["default"])({}, this.props.deckGlProps, {
          viewState: mapState,
          id: "default-deckgl-overlay",
          layers: deckGlLayers,
          onWebGLInitialized: this._onWebGLInitialized,
          onBeforeRender: this._onBeforeRender,
          onHover: visStateActions.onLayerHover,
          onClick: visStateActions.onLayerClick
        }));
      }
    }, {
      key: "_updateMapboxLayers",
      value: function _updateMapboxLayers() {
        var mapboxLayers = this.mapboxLayersSelector(this.props);

        if (!Object.keys(mapboxLayers).length && !Object.keys(this.previousLayers).length) {
          return;
        }

        (0, _mapboxUtils.updateMapboxLayers)(this._map, mapboxLayers, this.previousLayers);
        this.previousLayers = mapboxLayers;
      }
    }, {
      key: "_renderMapboxOverlays",
      value: function _renderMapboxOverlays() {
        if (this._map && this._map.isStyleLoaded()) {
          this._updateMapboxLayers();
        }
      }
    }, {
      key: "render",
      value: function render() {
        var _this$props5 = this.props,
            mapState = _this$props5.mapState,
            mapStyle = _this$props5.mapStyle,
            mapStateActions = _this$props5.mapStateActions,
            mapLayers = _this$props5.mapLayers,
            layers = _this$props5.layers,
            MapComponent = _this$props5.MapComponent,
            datasets = _this$props5.datasets,
            mapboxApiAccessToken = _this$props5.mapboxApiAccessToken,
            mapboxApiUrl = _this$props5.mapboxApiUrl,
            mapControls = _this$props5.mapControls,
            toggleMapControl = _this$props5.toggleMapControl;
        var layersToRender = this.layersToRenderSelector(this.props);

        if (!mapStyle.bottomMapStyle) {
          // style not yet loaded
          return _react["default"].createElement("div", null);
        }

        var mapProps = _objectSpread({}, mapState, {
          preserveDrawingBuffer: true,
          mapboxApiAccessToken: mapboxApiAccessToken,
          mapboxApiUrl: mapboxApiUrl,
          onViewportChange: this._onViewportChange,
          transformRequest: _mapboxUtils2.transformRequest
        });

        return _react["default"].createElement(_styledComponents.StyledMapContainer, {
          style: MAP_STYLE.container
        }, _react["default"].createElement(MapControl, {
          datasets: datasets,
          dragRotate: mapState.dragRotate,
          isSplit: Boolean(mapLayers),
          isExport: this.props.isExport,
          layers: layers,
          layersToRender: layersToRender,
          mapIndex: this.props.index,
          mapControls: mapControls,
          readOnly: this.props.readOnly,
          scale: mapState.scale || 1,
          top: 0,
          onTogglePerspective: mapStateActions.togglePerspective,
          onToggleSplitMap: mapStateActions.toggleSplitMap,
          onMapToggleLayer: this._handleMapToggleLayer,
          onToggleMapControl: toggleMapControl
        }), _react["default"].createElement(MapComponent, (0, _extends2["default"])({}, mapProps, {
          key: "bottom",
          ref: this._setMapboxMap,
          mapStyle: mapStyle.bottomMapStyle,
          getCursor: this.props.hoverInfo ? function () {
            return 'pointer';
          } : undefined,
          transitionDuration: TRANSITION_DURATION,
          onMouseMove: this.props.visStateActions.onMouseMove
        }), this._renderDeckOverlay(layersToRender), this._renderMapboxOverlays(layersToRender)), mapStyle.topMapStyle && _react["default"].createElement("div", {
          style: MAP_STYLE.top
        }, _react["default"].createElement(MapComponent, (0, _extends2["default"])({}, mapProps, {
          key: "top",
          mapStyle: mapStyle.topMapStyle
        }))), this._renderMapPopover(layersToRender));
      }
    }]);
    return MapContainer;
  }(_react.Component);

  (0, _defineProperty2["default"])(MapContainer, "propTypes", {
    // required
    datasets: _propTypes["default"].object,
    interactionConfig: _propTypes["default"].object.isRequired,
    layerBlending: _propTypes["default"].string.isRequired,
    layerOrder: _propTypes["default"].arrayOf(_propTypes["default"].any).isRequired,
    layerData: _propTypes["default"].arrayOf(_propTypes["default"].any).isRequired,
    layers: _propTypes["default"].arrayOf(_propTypes["default"].any).isRequired,
    mapState: _propTypes["default"].object.isRequired,
    mapStyle: _propTypes["default"].object.isRequired,
    mapControls: _propTypes["default"].object.isRequired,
    mousePos: _propTypes["default"].object.isRequired,
    mapboxApiAccessToken: _propTypes["default"].string.isRequired,
    mapboxApiUrl: _propTypes["default"].string,
    toggleMapControl: _propTypes["default"].func.isRequired,
    visStateActions: _propTypes["default"].object.isRequired,
    mapStateActions: _propTypes["default"].object.isRequired,
    // optional
    readOnly: _propTypes["default"].bool,
    isExport: _propTypes["default"].bool,
    clicked: _propTypes["default"].object,
    hoverInfo: _propTypes["default"].object,
    mapLayers: _propTypes["default"].object,
    onMapToggleLayer: _propTypes["default"].func,
    onMapStyleLoaded: _propTypes["default"].func,
    onMapRender: _propTypes["default"].func,
    getMapboxRef: _propTypes["default"].func
  });
  (0, _defineProperty2["default"])(MapContainer, "defaultProps", {
    MapComponent: _reactMapGl["default"],
    deckGlProps: {}
  });
  return MapContainer;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb21wb25lbnRzL21hcC1jb250YWluZXIuanMiXSwibmFtZXMiOlsiTUFQX1NUWUxFIiwiY29udGFpbmVyIiwiZGlzcGxheSIsInBvc2l0aW9uIiwidG9wIiwicG9pbnRlckV2ZW50cyIsIk1BUEJPWEdMX1NUWUxFX1VQREFURSIsIk1BUEJPWEdMX1JFTkRFUiIsIlRSQU5TSVRJT05fRFVSQVRJT04iLCJNYXBDb250YWluZXJGYWN0b3J5IiwiZGVwcyIsIk1hcFBvcG92ZXJGYWN0b3J5IiwiTWFwQ29udHJvbEZhY3RvcnkiLCJNYXBQb3BvdmVyIiwiTWFwQ29udHJvbCIsIk1hcENvbnRhaW5lciIsInByb3BzIiwibGF5ZXJzIiwibGF5ZXJEYXRhIiwibWFwTGF5ZXJzIiwibGF5ZXJPcmRlciIsImxheWVyc1NlbGVjdG9yIiwibGF5ZXJEYXRhU2VsZWN0b3IiLCJtYXBMYXllcnNTZWxlY3RvciIsInJlZHVjZSIsImFjY3UiLCJsYXllciIsImlkeCIsImlkIiwic2hvdWxkUmVuZGVyTGF5ZXIiLCJfaXNWaXNpYmxlTWFwTGF5ZXIiLCJsYXllck9yZGVyU2VsZWN0b3IiLCJsYXllcnNUb1JlbmRlclNlbGVjdG9yIiwiZ2VuZXJhdGVNYXBib3hMYXllcnMiLCJ2aXNTdGF0ZUFjdGlvbnMiLCJvbkxheWVyQ2xpY2siLCJjb2xvckRvbWFpbiIsImxheWVyQ29uZmlnQ2hhbmdlIiwib25XZWJHTEluaXRpYWxpemVkIiwibGF5ZXJJZCIsImluZGV4IiwibWFwSW5kZXgiLCJ0b2dnbGVMYXllckZvck1hcCIsInByZXZpb3VzTGF5ZXJzIiwiX3VwZGF0ZU1hcGJveExheWVycyIsIm9uTWFwU3R5bGVMb2FkZWQiLCJfbWFwIiwibWFwYm94IiwiZ2V0TWFwIiwib24iLCJfb25NYXBib3hTdHlsZVVwZGF0ZSIsIm9uTWFwUmVuZGVyIiwiZ2V0TWFwYm94UmVmIiwiZ2wiLCJsYXllckJsZW5kaW5nIiwib3ZlcmxheXMiLCJob3ZlckluZm8iLCJjbGlja2VkIiwibWFwU3RhdGUiLCJpbnRlcmFjdGlvbkNvbmZpZyIsIm1vdXNlUG9zIiwiYW5pbWF0aW9uQ29uZmlnIiwiZGF0YSIsImxheWVySW50ZXJhY3Rpb24iLCJtb3VzZVBvc2l0aW9uIiwid3JhcExvbmdpdHVkZSIsIm9iamVjdEhvdmVyZWQiLCJsYXllckNhbGxiYWNrcyIsIm9uU2V0TGF5ZXJEb21haW4iLCJ2YWwiLCJfb25MYXllclNldERvbWFpbiIsImxheWVyT3ZlcmxheSIsInJlbmRlckxheWVyIiwiY29uY2F0Iiwidmlld1N0YXRlIiwib25WaWV3U3RhdGVDaGFuZ2UiLCJtYXBTdGF0ZUFjdGlvbnMiLCJ1cGRhdGVNYXAiLCJvZmYiLCJsYXllcnNUb1JlbmRlciIsImRhdGFzZXRzIiwiY29vcmRpbmF0ZSIsInBpbm5lZCIsIm9iamVjdEluZm8iLCJsYXllckhvdmVyUHJvcCIsIngiLCJ5IiwidG9vbHRpcCIsImVuYWJsZWQiLCJwaWNrZWQiLCJvYmplY3QiLCJvdmVybGF5IiwiZ2V0SG92ZXJEYXRhIiwiZGF0YUlkIiwiY29uZmlnIiwiYWxsRGF0YSIsImZpZWxkcyIsImZpZWxkc1RvU2hvdyIsInZpZXdwb3J0IiwiV2ViTWVyY2F0b3JWaWV3cG9ydCIsImxuZ0xhdCIsIl9nZXRIb3ZlclhZIiwiQm9vbGVhbiIsIl9vbkNsb3NlTWFwUG9wb3ZlciIsIndpZHRoIiwiaGVpZ2h0Iiwic2NyZWVuQ29vcmQiLCJwcm9qZWN0IiwibWFwU3R5bGUiLCJtYXBib3hBcGlBY2Nlc3NUb2tlbiIsIm1hcGJveEFwaVVybCIsImRlY2tHbExheWVycyIsImxlbmd0aCIsInNsaWNlIiwicmV2ZXJzZSIsImZpbHRlciIsIm92ZXJsYXlUeXBlIiwiT1ZFUkxBWV9UWVBFIiwiZGVja2dsIiwiX3JlbmRlckxheWVyIiwidmlzaWJsZUxheWVyR3JvdXBzIiwicHVzaCIsIlRocmVlREJ1aWxkaW5nTGF5ZXIiLCJ0aHJlZURCdWlsZGluZ0NvbG9yIiwidXBkYXRlVHJpZ2dlcnMiLCJnZXRGaWxsQ29sb3IiLCJkZWNrR2xQcm9wcyIsIl9vbldlYkdMSW5pdGlhbGl6ZWQiLCJfb25CZWZvcmVSZW5kZXIiLCJvbkxheWVySG92ZXIiLCJtYXBib3hMYXllcnMiLCJtYXBib3hMYXllcnNTZWxlY3RvciIsIk9iamVjdCIsImtleXMiLCJpc1N0eWxlTG9hZGVkIiwiTWFwQ29tcG9uZW50IiwibWFwQ29udHJvbHMiLCJ0b2dnbGVNYXBDb250cm9sIiwiYm90dG9tTWFwU3R5bGUiLCJtYXBQcm9wcyIsInByZXNlcnZlRHJhd2luZ0J1ZmZlciIsIm9uVmlld3BvcnRDaGFuZ2UiLCJfb25WaWV3cG9ydENoYW5nZSIsInRyYW5zZm9ybVJlcXVlc3QiLCJkcmFnUm90YXRlIiwiaXNFeHBvcnQiLCJyZWFkT25seSIsInNjYWxlIiwidG9nZ2xlUGVyc3BlY3RpdmUiLCJ0b2dnbGVTcGxpdE1hcCIsIl9oYW5kbGVNYXBUb2dnbGVMYXllciIsIl9zZXRNYXBib3hNYXAiLCJ1bmRlZmluZWQiLCJvbk1vdXNlTW92ZSIsIl9yZW5kZXJEZWNrT3ZlcmxheSIsIl9yZW5kZXJNYXBib3hPdmVybGF5cyIsInRvcE1hcFN0eWxlIiwiX3JlbmRlck1hcFBvcG92ZXIiLCJDb21wb25lbnQiLCJQcm9wVHlwZXMiLCJpc1JlcXVpcmVkIiwic3RyaW5nIiwiYXJyYXlPZiIsImFueSIsImZ1bmMiLCJib29sIiwib25NYXBUb2dnbGVMYXllciIsIk1hcGJveEdMTWFwIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFxQkE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBR0E7O0FBQ0E7O0FBQ0E7O0FBR0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBR0E7Ozs7OztBQUVBLElBQU1BLFNBQVMsR0FBRztBQUNoQkMsRUFBQUEsU0FBUyxFQUFFO0FBQ1RDLElBQUFBLE9BQU8sRUFBRSxjQURBO0FBRVRDLElBQUFBLFFBQVEsRUFBRTtBQUZELEdBREs7QUFLaEJDLEVBQUFBLEdBQUcsRUFBRTtBQUNIRCxJQUFBQSxRQUFRLEVBQUUs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akJ4QixJQUFBQSxnQkFBZ0IsRUFBRXNCLHNCQUFVSyxJQUFWLENBQWVKLFVBZGhCO0FBZWpCOUgsSUFBQUEsZUFBZSxFQUFFNkgsc0JBQVVyRSxNQUFWLENBQWlCc0UsVUFmakI7QUFnQmpCcEYsSUFBQUEsZUFBZSxFQUFFbUYsc0JBQVVyRSxNQUFWLENBQWlCc0UsVUFoQmpCO0FBa0JqQjtBQUNBZCxJQUFBQSxRQUFRLEVBQUVhLHNCQUFVTSxJQW5CSDtBQW9CakJwQixJQUFBQSxRQUFRLEVBQUVjLHNCQUFVTSxJQXBCSDtBQXFCakI1RyxJQUFBQSxPQUFPLEVBQUVzRyxzQkFBVXJFLE1BckJGO0FBc0JqQmxDLElBQUFBLFNBQVMsRUFBRXVHLHNCQUFVckUsTUF0Qko7QUF1QmpCdkUsSUFBQUEsU0FBUyxFQUFFNEksc0JBQVVyRSxNQXZCSjtBQXdCakI0RSxJQUFBQSxnQkFBZ0IsRUFBRVAsc0JBQVVLLElBeEJYO0FBeUJqQnZILElBQUFBLGdCQUFnQixFQUFFa0gsc0JBQVVLLElBekJYO0FBMEJqQmpILElBQUFBLFdBQVcsRUFBRTRHLHNCQUFVSyxJQTFCTjtBQTJCakJoSCxJQUFBQSxZQUFZLEVBQUUyRyxzQkFBVUs7QUEzQlAsR0FGNkM7QUFBQSxtQ0FDNURySixZQUQ0RCxrQkFnQzFDO0FBQ3BCd0gsSUFBQUEsWUFBWSxFQUFFZ0Msc0JBRE07QUFFcEJ6QyxJQUFBQSxXQUFXLEVBQUU7QUFGTyxHQWhDMEM7QUFpYWxFLFNBQU8vRyxZQUFQO0FBQ0QiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgKGMpIDIwMTkgVWJlciBUZWNobm9sb2dpZXMsIEluYy5cbi8vXG4vLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4vLyBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4vLyBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4vLyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4vLyBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbi8vIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4vL1xuLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbi8vIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1Jcbi8vIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuLy8gRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4vLyBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4vLyBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuLy8gT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuLy8gVEhFIFNPRlRXQVJFLlxuXG4vLyBsaWJyYXJpZXNcbmltcG9ydCBSZWFjdCwge0NvbXBvbmVudH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCBNYXBib3hHTE1hcCBmcm9tICdyZWFjdC1tYXAtZ2wnO1xuaW1wb3J0IERlY2tHTCBmcm9tICdkZWNrLmdsJztcbmltcG9ydCB7Y3JlYXRlU2VsZWN0b3J9IGZyb20gJ3Jlc2VsZWN0JztcbmltcG9ydCBXZWJNZXJjYXRvclZpZXdwb3J0IGZyb20gJ3ZpZXdwb3J0LW1lcmNhdG9yLXByb2plY3QnO1xuXG4vLyBjb21wb25lbnRzXG5pbXBvcnQgTWFwUG9wb3ZlckZhY3RvcnkgZnJvbSAnY29tcG9uZW50cy9tYXAvbWFwLXBvcG92ZXInO1xuaW1wb3J0IE1hcENvbnRyb2xGYWN0b3J5IGZyb20gJ2NvbXBvbmVudHMvbWFwL21hcC1jb250cm9sJztcbmltcG9ydCB7U3R5bGVkTWFwQ29udGFpbmVyfSBmcm9tICdjb21wb25lbnRzL2NvbW1vbi9zdHlsZWQtY29tcG9uZW50cyc7XG5cbi8vIHV0aWxzXG5pbXBvcnQge2dlbmVyYXRlTWFwYm94TGF5ZXJzLCB1cGRhdGVNYXBib3hMYXllcnN9IGZyb20gJ2xheWVycy9tYXBib3gtdXRpbHMnO1xuaW1wb3J0IHtPVkVSTEFZX1RZUEV9IGZyb20gJ2xheWVycy9iYXNlLWxheWVyJztcbmltcG9ydCB7b25XZWJHTEluaXRpYWxpemVkLCBzZXRMYXllckJsZW5kaW5nfSBmcm9tICd1dGlscy9nbC11dGlscyc7XG5pbXBvcnQge3RyYW5zZm9ybVJlcXVlc3R9IGZyb20gJ3V0aWxzL21hcC1zdHlsZS11dGlscy9tYXBib3gtdXRpbHMnO1xuXG4vLyBkZWZhdWx0LXNldHRpbmdzXG5pbXBvcnQgVGhyZWVEQnVpbGRpbmdMYXllciBmcm9tICdkZWNrZ2wtbGF5ZXJzLzNkLWJ1aWxkaW5nLWxheWVyLzNkLWJ1aWxkaW5nLWxheWVyJztcblxuY29uc3QgTUFQX1NUWUxFID0ge1xuICBjb250YWluZXI6IHtcbiAgICBkaXNwbGF5OiAnaW5saW5lLWJsb2NrJyxcbiAgICBwb3NpdGlvbjogJ3JlbGF0aXZlJ1xuICB9LFxuICB0b3A6IHtcbiAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgICB0b3A6ICcwcHgnLFxuICAgIHBvaW50ZXJFdmVudHM6ICdub25lJ1xuICB9XG59O1xuXG5jb25zdCBNQVBCT1hHTF9TVFlMRV9VUERBVEUgPSAnc3R5bGUubG9hZCc7XG5jb25zdCBNQVBCT1hHTF9SRU5ERVIgPSAncmVuZGVyJztcbmNvbnN0IFRSQU5TSVRJT05fRFVSQVRJT04gPSAwO1xuXG5NYXBDb250YWluZXJGYWN0b3J5LmRlcHMgPSBbTWFwUG9wb3ZlckZhY3RvcnksIE1hcENvbnRyb2xGYWN0b3J5XTtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gTWFwQ29udGFpbmVyRmFjdG9yeShNYXBQb3BvdmVyLCBNYXBDb250cm9sKSB7XG4gIGNsYXNzIE1hcENvbnRhaW5lciBleHRlbmRzIENvbXBvbmVudCB7XG4gICAgc3RhdGljIHByb3BUeXBlcyA9IHtcbiAgICAgIC8vIHJlcXVpcmVkXG4gICAgICBkYXRhc2V0czogUHJvcFR5cGVzLm9iamVjdCxcbiAgICAgIGludGVyYWN0aW9uQ29uZmlnOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gICAgICBsYXllckJsZW5kaW5nOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgICBsYXllck9yZGVyOiBQcm9wVHlwZXMuYXJyYXlPZihQcm9wVHlwZXMuYW55KS5pc1JlcXVpcmVkLFxuICAgICAgbGF5ZXJEYXRhOiBQcm9wVHlwZXMuYXJyYXlPZihQcm9wVHlwZXMuYW55KS5pc1JlcXVpcmVkLFxuICAgICAgbGF5ZXJzOiBQcm9wVHlwZXMuYXJyYXlPZihQcm9wVHlwZXMuYW55KS5pc1JlcXVpcmVkLFxuICAgICAgbWFwU3RhdGU6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgICAgIG1hcFN0eWxlOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gICAgICBtYXBDb250cm9sczogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxuICAgICAgbW91c2VQb3M6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgICAgIG1hcGJveEFwaUFjY2Vzc1Rva2VuOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgICBtYXBib3hBcGlVcmw6IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgICB0b2dnbGVNYXBDb250cm9sOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICAgICAgdmlzU3RhdGVBY3Rpb25zOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gICAgICBtYXBTdGF0ZUFjdGlvbnM6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcblxuICAgICAgLy8gb3B0aW9uYWxcbiAgICAgIHJlYWRPbmx5OiBQcm9wVHlwZXMuYm9vbCxcbiAgICAgIGlzRXhwb3J0OiBQcm9wVHlwZXMuYm9vbCxcbiAgICAgIGNsaWNrZWQ6IFByb3BUeXBlcy5vYmplY3QsXG4gICAgICBob3ZlckluZm86IFByb3BUeXBlcy5vYmplY3QsXG4gICAgICBtYXBMYXllcnM6IFByb3BUeXBlcy5vYmplY3QsXG4gICAgICBvbk1hcFRvZ2dsZUxheWVyOiBQcm9wVHlwZXMuZnVuYyxcbiAgICAgIG9uTWFwU3R5bGVMb2FkZWQ6IFByb3BUeXBlcy5mdW5jLFxuICAgICAgb25NYXBSZW5kZXI6IFByb3BUeXBlcy5mdW5jLFxuICAgICAgZ2V0TWFwYm94UmVmOiBQcm9wVHlwZXMuZnVuY1xuICAgIH07XG5cbiAgICBzdGF0aWMgZGVmYXVsdFByb3BzID0ge1xuICAgICAgTWFwQ29tcG9uZW50OiBNYXBib3hHTE1hcCxcbiAgICAgIGRlY2tHbFByb3BzOiB7fVxuICAgIH07XG5cbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgICAgc3VwZXIocHJvcHMpO1xuXG4gICAgICB0aGlzLnByZXZpb3VzTGF5ZXJzID0ge1xuICAgICAgICAvLyBbbGF5ZXJzLmlkXTogbWFwYm94TGF5ZXJDb25maWdcbiAgICAgIH07XG4gICAgfVxuXG4gICAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgICAvLyB1bmJpbmQgbWFwYm94Z2wgZXZlbnQgbGlzdGVuZXJcbiAgICAgIGlmICh0aGlzLl9tYXApIHtcbiAgICAgICAgdGhpcy5fbWFwLm9mZihNQVBCT1hHTF9TVFlMRV9VUERBVEUpO1xuICAgICAgICB0aGlzLl9tYXAub2ZmKE1BUEJPWEdMX1JFTkRFUik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgbGF5ZXJzU2VsZWN0b3IgPSBwcm9wcyA9PiBwcm9wcy5sYXllcnM7XG4gICAgbGF5ZXJEYXRhU2VsZWN0b3IgPSBwcm9wcyA9PiBwcm9wcy5sYXllckRhdGE7XG4gICAgbWFwTGF5ZXJzU2VsZWN0b3IgPSBwcm9wcyA9PiBwcm9wcy5tYXBMYXllcnM7XG4gICAgbGF5ZXJPcmRlclNlbGVjdG9yID0gcHJvcHMgPT4gcHJvcHMubGF5ZXJPcmRlcjtcbiAgICBsYXllcnNUb1JlbmRlclNlbGVjdG9yID0gY3JlYXRlU2VsZWN0b3IoXG4gICAgICB0aGlzLmxheWVyc1NlbGVjdG9yLFxuICAgICAgdGhpcy5sYXllckRhdGFTZWxlY3RvcixcbiAgICAgIHRoaXMubWFwTGF5ZXJzU2VsZWN0b3IsXG4gICAgICAvLyB7W2lkXTogdHJ1ZSBcXCBmYWxzZX1cbiAgICAgIChsYXllcnMsIGxheWVyRGF0YSwgbWFwTGF5ZXJzKSA9PiBsYXllcnMucmVkdWNlKChhY2N1LCBsYXllciwgaWR4KSA9PiAoe1xuICAgICAgICAuLi5hY2N1LFxuICAgICAgICBbbGF5ZXIuaWRdOiBsYXllci5zaG91bGRSZW5kZXJMYXllcihsYXllckRhdGFbaWR4XSkgJiZcbiAgICAgICAgICB0aGlzLl9pc1Zpc2libGVNYXBMYXllcihsYXllciwgbWFwTGF5ZXJzKVxuICAgICAgfSksIHt9KVxuICAgICk7XG5cbiAgICBtYXBib3hMYXllcnNTZWxlY3RvciA9IGNyZWF0ZVNlbGVjdG9yKFxuICAgICAgdGhpcy5sYXllcnNTZWxlY3RvcixcbiAgICAgIHRoaXMubGF5ZXJEYXRhU2VsZWN0b3IsXG4gICAgICB0aGlzLmxheWVyT3JkZXJTZWxlY3RvcixcbiAgICAgIHRoaXMubGF5ZXJzVG9SZW5kZXJTZWxlY3RvcixcbiAgICAgIGdlbmVyYXRlTWFwYm94TGF5ZXJzXG4gICAgKVxuICAgIC8qIGNvbXBvbmVudCBwcml2YXRlIGZ1bmN0aW9ucyAqL1xuICAgIF9pc1Zpc2libGVNYXBMYXllcihsYXllciwgbWFwTGF5ZXJzKSB7XG4gICAgICAvLyBpZiBsYXllci5pZCBpcyBub3QgaW4gbWFwTGF5ZXJzLCBkb24ndCByZW5kZXIgaXRcbiAgICAgIHJldHVybiAhbWFwTGF5ZXJzIHx8IChtYXBMYXllcnMgJiYgbWFwTGF5ZXJzW2xheWVyLmlkXSk7XG4gICAgfVxuXG4gICAgX29uQ2xvc2VNYXBQb3BvdmVyID0gKCkgPT4ge1xuICAgICAgdGhpcy5wcm9wcy52aXNTdGF0ZUFjdGlvbnMub25MYXllckNsaWNrKG51bGwpO1xuICAgIH07XG5cbiAgICBfb25MYXllclNldERvbWFpbiA9IChpZHgsIGNvbG9yRG9tYWluKSA9PiB7XG4gICAgICB0aGlzLnByb3BzLnZpc1N0YXRlQWN0aW9ucy5sYXllckNvbmZpZ0NoYW5nZSh0aGlzLnByb3BzLmxheWVyc1tpZHhdLCB7XG4gICAgICAgIGNvbG9yRG9tYWluXG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgX29uV2ViR0xJbml0aWFsaXplZCA9IG9uV2ViR0xJbml0aWFsaXplZDtcblxuICAgIF9oYW5kbGVNYXBUb2dnbGVMYXllciA9IGxheWVySWQgPT4ge1xuICAgICAgY29uc3Qge2luZGV4OiBtYXBJbmRleCA9IDAsIHZpc1N0YXRlQWN0aW9uc30gPSB0aGlzLnByb3BzO1xuICAgICAgdmlzU3RhdGVBY3Rpb25zLnRvZ2dsZUxheWVyRm9yTWFwKG1hcEluZGV4LCBsYXllcklkKTtcbiAgICB9O1xuXG4gICAgX29uTWFwYm94U3R5bGVVcGRhdGUgPSAoKSA9PiB7XG4gICAgICAvLyBmb3JjZSByZWZyZXNoIG1hcGJveGdsIGxheWVyc1xuICAgICAgdGhpcy5wcmV2aW91c0xheWVycyA9IHt9O1xuICAgICAgdGhpcy5fdXBkYXRlTWFwYm94TGF5ZXJzKCk7XG5cbiAgICAgIGlmICh0eXBlb2YgdGhpcy5wcm9wcy5vbk1hcFN0eWxlTG9hZGVkID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRoaXMucHJvcHMub25NYXBTdHlsZUxvYWRlZCh0aGlzLl9tYXApO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBfc2V0TWFwYm94TWFwID0gbWFwYm94ID0+IHtcbiAgICAgIGlmICghdGhpcy5fbWFwICYmIG1hcGJveCkge1xuICAgICAgICB0aGlzLl9tYXAgPSBtYXBib3guZ2V0TWFwKCk7XG4gICAgICAgIC8vIGkgbm90aWNlZCBpbiBjZXJ0YWluIGNvbnRleHQgd2UgZG9uJ3QgYWNjZXNzIHRoZSBhY3R1YWwgbWFwIGVsZW1lbnRcbiAgICAgICAgaWYgKCF0aGlzLl9tYXApIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLy8gYmluZCBtYXBib3hnbCBldmVudCBsaXN0ZW5lclxuICAgICAgICB0aGlzLl9tYXAub24oTUFQQk9YR0xfU1RZTEVfVVBEQVRFLCB0aGlzLl9vbk1hcGJveFN0eWxlVXBkYXRlKTtcblxuICAgICAgICB0aGlzLl9tYXAub24oTUFQQk9YR0xfUkVOREVSLCAoKSA9PiB7XG4gICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLnByb3BzLm9uTWFwUmVuZGVyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICB0aGlzLnByb3BzLm9uTWFwUmVuZGVyKHRoaXMuX21hcCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMucHJvcHMuZ2V0TWFwYm94UmVmKSB7XG4gICAgICAgIC8vIFRoZSBwYXJlbnQgY29tcG9uZW50IGNhbiBnYWluIGFjY2VzcyB0byBvdXIgTWFwYm94R2xNYXAgYnlcbiAgICAgICAgLy8gcHJvdmlkaW5nIHRoaXMgY2FsbGJhY2suIE5vdGUgdGhhdCAnbWFwYm94JyB3aWxsIGJlIG51bGwgd2hlbiB0aGVcbiAgICAgICAgLy8gcmVmIGlzIHVuc2V0IChlLmcuIHdoZW4gYSBzcGxpdCBtYXAgaXMgY2xvc2VkKS5cbiAgICAgICAgdGhpcy5wcm9wcy5nZXRNYXBib3hSZWYobWFwYm94LCB0aGlzLnByb3BzLmluZGV4KTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgX29uQmVmb3JlUmVuZGVyID0gKHtnbH0pID0+IHtcbiAgICAgIHNldExheWVyQmxlbmRpbmcoZ2wsIHRoaXMucHJvcHMubGF5ZXJCbGVuZGluZyk7XG4gICAgfTtcblxuICAgIC8qIGNvbXBvbmVudCByZW5kZXIgZnVuY3Rpb25zICovXG4gICAgLyogZXNsaW50LWRpc2FibGUgY29tcGxleGl0eSAqL1xuICAgIF9yZW5kZXJNYXBQb3BvdmVyKGxheWVyc1RvUmVuZGVyKSB7XG4gICAgICAvLyBUT0RPOiBtb3ZlIHRoaXMgaW50byByZWR1Y2VyIHNvIGl0IGNhbiBiZSB0ZXN0ZWRcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgbWFwU3RhdGUsXG4gICAgICAgIGhvdmVySW5mbyxcbiAgICAgICAgY2xpY2tlZCxcbiAgICAgICAgZGF0YXNldHMsXG4gICAgICAgIGludGVyYWN0aW9uQ29uZmlnLFxuICAgICAgICBsYXllcnMsXG4gICAgICAgIG1vdXNlUG9zOiB7bW91c2VQb3NpdGlvbiwgY29vcmRpbmF0ZSwgcGlubmVkfVxuICAgICAgfSA9IHRoaXMucHJvcHM7XG5cbiAgICAgIGlmICghbW91c2VQb3NpdGlvbikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIC8vIGlmIGNsaWNrZWQgc29tZXRoaW5nLCBpZ25vcmUgaG92ZXIgYmVoYXZpb3JcbiAgICAgIGNvbnN0IG9iamVjdEluZm8gPSBjbGlja2VkIHx8IGhvdmVySW5mbztcbiAgICAgIGxldCBsYXllckhvdmVyUHJvcCA9IG51bGw7XG4gICAgICBsZXQgcG9zaXRpb24gPSB7eDogbW91c2VQb3NpdGlvblswXSwgeTogbW91c2VQb3NpdGlvblsxXX07XG5cbiAgICAgIGlmIChcbiAgICAgICAgaW50ZXJhY3Rpb25Db25maWcudG9vbHRpcC5lbmFibGVkICYmXG4gICAgICAgIG9iamVjdEluZm8gJiZcbiAgICAgICAgb2JqZWN0SW5mby5waWNrZWRcbiAgICAgICkge1xuICAgICAgICAvLyBpZiBhbnl0aGluZyBob3ZlcmVkXG4gICAgICAgIGNvbnN0IHtvYmplY3QsIGxheWVyOiBvdmVybGF5fSA9IG9iamVjdEluZm87XG5cbiAgICAgICAgLy8gZGVja2dsIGxheWVyIHRvIGtlcGxlci1nbCBsYXllclxuICAgICAgICBjb25zdCBsYXllciA9IGxheWVyc1tvdmVybGF5LnByb3BzLmlkeF07XG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgIGxheWVyLmdldEhvdmVyRGF0YSAmJlxuICAgICAgICAgIGxheWVyc1RvUmVuZGVyW2xheWVyLmlkXVxuICAgICAgICApIHtcbiAgICAgICAgICAvLyBpZiBsYXllciBpcyB2aXNpYmxlIGFuZCBoYXZlIGhvdmVyZWQgZGF0YVxuICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIGNvbmZpZzoge2RhdGFJZH1cbiAgICAgICAgICB9ID0gbGF5ZXI7XG4gICAgICAgICAgY29uc3Qge2FsbERhdGEsIGZpZWxkc30gPSBkYXRhc2V0c1tkYXRhSWRdO1xuICAgICAgICAgIGNvbnN0IGRhdGEgPSBsYXllci5nZXRIb3ZlckRhdGEob2JqZWN0LCBhbGxEYXRhKTtcbiAgICAgICAgICBjb25zdCBmaWVsZHNUb1Nob3cgPVxuICAgICAgICAgICAgaW50ZXJhY3Rpb25Db25maWcudG9vbHRpcC5jb25maWcuZmllbGRzVG9TaG93W2RhdGFJZF07XG5cbiAgICAgICAgICBsYXllckhvdmVyUHJvcCA9IHtcbiAgICAgICAgICAgIGRhdGEsXG4gICAgICAgICAgICBmaWVsZHMsXG4gICAgICAgICAgICBmaWVsZHNUb1Nob3csXG4gICAgICAgICAgICBsYXllclxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKHBpbm5lZCB8fCBjbGlja2VkKSB7XG4gICAgICAgIC8vIHByb2plY3QgbG5nbGF0IHRvIHNjcmVlbiBzbyB0aGF0IHRvb2x0aXAgZm9sbG93cyB0aGUgb2JqZWN0IG9uIHpvb21cbiAgICAgICAgY29uc3Qgdmlld3BvcnQgPSBuZXcgV2ViTWVyY2F0b3JWaWV3cG9ydChtYXBTdGF0ZSk7XG4gICAgICAgIGNvbnN0IGxuZ0xhdCA9IGNsaWNrZWQgPyBjbGlja2VkLmxuZ0xhdCA6IHBpbm5lZC5jb29yZGluYXRlO1xuICAgICAgICBwb3NpdGlvbiA9IHRoaXMuX2dldEhvdmVyWFkodmlld3BvcnQsIGxuZ0xhdCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gKFxuICAgICAgICA8ZGl2PlxuICAgICAgICAgIDxNYXBQb3BvdmVyXG4gICAgICAgICAgICB7Li4ucG9zaXRpb259XG4gICAgICAgICAgICBsYXllckhvdmVyUHJvcD17bGF5ZXJIb3ZlclByb3B9XG4gICAgICAgICAgICBjb29yZGluYXRlPXtcbiAgICAgICAgICAgICAgaW50ZXJhY3Rpb25Db25maWcuY29vcmRpbmF0ZS5lbmFibGVkICYmXG4gICAgICAgICAgICAgICgocGlubmVkIHx8IHt9KS5jb29yZGluYXRlIHx8IGNvb3JkaW5hdGUpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmcmVlemVkPXtCb29sZWFuKGNsaWNrZWQgfHwgcGlubmVkKX1cbiAgICAgICAgICAgIG9uQ2xvc2U9e3RoaXMuX29uQ2xvc2VNYXBQb3BvdmVyfVxuICAgICAgICAgICAgbWFwVz17bWFwU3RhdGUud2lkdGh9XG4gICAgICAgICAgICBtYXBIPXttYXBTdGF0ZS5oZWlnaHR9XG4gICAgICAgICAgLz5cbiAgICAgICAgPC9kaXY+XG4gICAgICApO1xuICAgIH1cblxuICAgIC8qIGVzbGludC1lbmFibGUgY29tcGxleGl0eSAqL1xuXG4gICAgX2dldEhvdmVyWFkodmlld3BvcnQsIGxuZ0xhdCkge1xuICAgICAgY29uc3Qgc2NyZWVuQ29vcmQgPVxuICAgICAgICAhdmlld3BvcnQgfHwgIWxuZ0xhdCA/IG51bGwgOiB2aWV3cG9ydC5wcm9qZWN0KGxuZ0xhdCk7XG5cbiAgICAgIHJldHVybiBzY3JlZW5Db29yZCAmJiB7eDogc2NyZWVuQ29vcmRbMF0sIHk6IHNjcmVlbkNvb3JkWzFdfTtcbiAgICB9XG5cbiAgICBfcmVuZGVyTGF5ZXIgPSAob3ZlcmxheXMsIGlkeCkgPT4ge1xuICAgICAgY29uc3Qge1xuICAgICAgICBsYXllcnMsXG4gICAgICAgIGxheWVyRGF0YSxcbiAgICAgICAgaG92ZXJJbmZvLFxuICAgICAgICBjbGlja2VkLFxuICAgICAgICBtYXBTdGF0ZSxcbiAgICAgICAgaW50ZXJhY3Rpb25Db25maWcsXG4gICAgICAgIG1vdXNlUG9zLFxuICAgICAgICBhbmltYXRpb25Db25maWdcbiAgICAgIH0gPSB0aGlzLnByb3BzO1xuICAgICAgY29uc3QgbGF5ZXIgPSBsYXllcnNbaWR4XTtcbiAgICAgIGNvbnN0IGRhdGEgPSBsYXllckRhdGFbaWR4XTtcblxuICAgICAgY29uc3QgbGF5ZXJJbnRlcmFjdGlvbiA9IHtcbiAgICAgICAgbW91c2VQb3NpdGlvbjogbW91c2VQb3MubW91c2VQb3NpdGlvbixcbiAgICAgICAgd3JhcExvbmdpdHVkZTogdHJ1ZVxuICAgICAgfTtcblxuICAgICAgY29uc3Qgb2JqZWN0SG92ZXJlZCA9IGNsaWNrZWQgfHwgaG92ZXJJbmZvO1xuICAgICAgY29uc3QgbGF5ZXJDYWxsYmFja3MgPSB7XG4gICAgICAgIG9uU2V0TGF5ZXJEb21haW46IHZhbCA9PiB0aGlzLl9vbkxheWVyU2V0RG9tYWluKGlkeCwgdmFsKVxuICAgICAgfTtcblxuICAgICAgLy8gTGF5ZXIgaXMgTGF5ZXIgY2xhc3NcbiAgICAgIGNvbnN0IGxheWVyT3ZlcmxheSA9IGxheWVyLnJlbmRlckxheWVyKHtcbiAgICAgICAgZGF0YSxcbiAgICAgICAgaWR4LFxuICAgICAgICBsYXllckludGVyYWN0aW9uLFxuICAgICAgICBvYmplY3RIb3ZlcmVkLFxuICAgICAgICBtYXBTdGF0ZSxcbiAgICAgICAgaW50ZXJhY3Rpb25Db25maWcsXG4gICAgICAgIGxheWVyQ2FsbGJhY2tzLFxuICAgICAgICBhbmltYXRpb25Db25maWdcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gb3ZlcmxheXMuY29uY2F0KGxheWVyT3ZlcmxheSB8fCBbXSk7XG4gICAgfTtcblxuICAgIF9yZW5kZXJEZWNrT3ZlcmxheShsYXllcnNUb1JlbmRlcikge1xuICAgICAgY29uc3Qge1xuICAgICAgICBtYXBTdGF0ZSxcbiAgICAgICAgbWFwU3R5bGUsXG4gICAgICAgIGxheWVyRGF0YSxcbiAgICAgICAgbGF5ZXJPcmRlcixcbiAgICAgICAgbGF5ZXJzLFxuICAgICAgICB2aXNTdGF0ZUFjdGlvbnMsXG4gICAgICAgIG1hcGJveEFwaUFjY2Vzc1Rva2VuLFxuICAgICAgICBtYXBib3hBcGlVcmxcbiAgICAgIH0gPSB0aGlzLnByb3BzO1xuXG4gICAgICBsZXQgZGVja0dsTGF5ZXJzID0gW107XG4gICAgICAvLyB3YWl0IHVudGlsIGRhdGEgaXMgcmVhZHkgYmVmb3JlIHJlbmRlciBkYXRhIGxheWVyc1xuICAgICAgaWYgKGxheWVyRGF0YSAmJiBsYXllckRhdGEubGVuZ3RoKSB7XG4gICAgICAgIC8vIGxhc3QgbGF5ZXIgcmVuZGVyIGZpcnN0XG4gICAgICAgIGRlY2tHbExheWVycyA9IGxheWVyT3JkZXJcbiAgICAgICAgICAuc2xpY2UoKVxuICAgICAgICAgIC5yZXZlcnNlKClcbiAgICAgICAgICAuZmlsdGVyKGlkeCA9PiBsYXllcnNbaWR4XS5vdmVybGF5VHlwZSA9PT0gT1ZFUkxBWV9UWVBFLmRlY2tnbCAmJiBsYXllcnNUb1JlbmRlcltsYXllcnNbaWR4XS5pZF0pXG4gICAgICAgICAgLnJlZHVjZSh0aGlzLl9yZW5kZXJMYXllciwgW10pO1xuICAgICAgfVxuXG4gICAgICBpZiAobWFwU3R5bGUudmlzaWJsZUxheWVyR3JvdXBzWyczZCBidWlsZGluZyddKSB7XG4gICAgICAgIGRlY2tHbExheWVycy5wdXNoKG5ldyBUaHJlZURCdWlsZGluZ0xheWVyKHtcbiAgICAgICAgICBpZDogJ19rZXBsZXJnbF8zZC1idWlsZGluZycsXG4gICAgICAgICAgbWFwYm94QXBpQWNjZXNzVG9rZW4sXG4gICAgICAgICAgbWFwYm94QXBpVXJsLFxuICAgICAgICAgIHRocmVlREJ1aWxkaW5nQ29sb3I6IG1hcFN0eWxlLnRocmVlREJ1aWxkaW5nQ29sb3IsXG4gICAgICAgICAgdXBkYXRlVHJpZ2dlcnM6IHtcbiAgICAgICAgICAgIGdldEZpbGxDb2xvcjogIG1hcFN0eWxlLnRocmVlREJ1aWxkaW5nQ29sb3JcbiAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIChcbiAgICAgICAgPERlY2tHTFxuICAgICAgICAgIHsuLi50aGlzLnByb3BzLmRlY2tHbFByb3BzfVxuICAgICAgICAgIHZpZXdTdGF0ZT17bWFwU3RhdGV9XG4gICAgICAgICAgaWQ9XCJkZWZhdWx0LWRlY2tnbC1vdmVybGF5XCJcbiAgICAgICAgICBsYXllcnM9e2RlY2tHbExheWVyc31cbiAgICAgICAgICBvbldlYkdMSW5pdGlhbGl6ZWQ9e3RoaXMuX29uV2ViR0xJbml0aWFsaXplZH1cbiAgICAgICAgICBvbkJlZm9yZVJlbmRlcj17dGhpcy5fb25CZWZvcmVSZW5kZXJ9XG4gICAgICAgICAgb25Ib3Zlcj17dmlzU3RhdGVBY3Rpb25zLm9uTGF5ZXJIb3Zlcn1cbiAgICAgICAgICBvbkNsaWNrPXt2aXNTdGF0ZUFjdGlvbnMub25MYXllckNsaWNrfVxuICAgICAgICAvPlxuICAgICAgKTtcbiAgICB9XG5cbiAgICBfdXBkYXRlTWFwYm94TGF5ZXJzKCkge1xuICAgICAgY29uc3QgbWFwYm94TGF5ZXJzID0gdGhpcy5tYXBib3hMYXllcnNTZWxlY3Rvcih0aGlzLnByb3BzKTtcbiAgICAgIGlmICghT2JqZWN0LmtleXMobWFwYm94TGF5ZXJzKS5sZW5ndGggJiYgIU9iamVjdC5rZXlzKHRoaXMucHJldmlvdXNMYXllcnMpLmxlbmd0aCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHVwZGF0ZU1hcGJveExheWVycyhcbiAgICAgICAgdGhpcy5fbWFwLFxuICAgICAgICBtYXBib3hMYXllcnMsXG4gICAgICAgIHRoaXMucHJldmlvdXNMYXllcnNcbiAgICAgICk7XG5cbiAgICAgIHRoaXMucHJldmlvdXNMYXllcnMgPSBtYXBib3hMYXllcnM7XG4gICAgfVxuXG4gICAgX3JlbmRlck1hcGJveE92ZXJsYXlzKCkge1xuICAgICAgaWYgKHRoaXMuX21hcCAmJiB0aGlzLl9tYXAuaXNTdHlsZUxvYWRlZCgpKSB7XG4gICAgICAgIHRoaXMuX3VwZGF0ZU1hcGJveExheWVycygpO1xuICAgICAgfVxuICAgIH1cblxuICAgIF9vblZpZXdwb3J0Q2hhbmdlID0gdmlld1N0YXRlID0+IHtcbiAgICAgIGlmICh0eXBlb2YgdGhpcy5wcm9wcy5vblZpZXdTdGF0ZUNoYW5nZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aGlzLnByb3BzLm9uVmlld1N0YXRlQ2hhbmdlKHZpZXdTdGF0ZSk7XG4gICAgICB9XG4gICAgICB0aGlzLnByb3BzLm1hcFN0YXRlQWN0aW9ucy51cGRhdGVNYXAodmlld1N0YXRlKTtcbiAgICB9O1xuXG4gICAgcmVuZGVyKCkge1xuICAgICAgY29uc3Qge1xuICAgICAgICBtYXBTdGF0ZSxcbiAgICAgICAgbWFwU3R5bGUsXG4gICAgICAgIG1hcFN0YXRlQWN0aW9ucyxcbiAgICAgICAgbWFwTGF5ZXJzLFxuICAgICAgICBsYXllcnMsXG4gICAgICAgIE1hcENvbXBvbmVudCxcbiAgICAgICAgZGF0YXNldHMsXG4gICAgICAgIG1hcGJveEFwaUFjY2Vzc1Rva2VuLFxuICAgICAgICBtYXBib3hBcGlVcmwsXG4gICAgICAgIG1hcENvbnRyb2xzLFxuICAgICAgICB0b2dnbGVNYXBDb250cm9sXG4gICAgICB9ID0gdGhpcy5wcm9wcztcbiAgICAgIGNvbnN0IGxheWVyc1RvUmVuZGVyID0gdGhpcy5sYXllcnNUb1JlbmRlclNlbGVjdG9yKHRoaXMucHJvcHMpO1xuICAgICAgaWYgKCFtYXBTdHlsZS5ib3R0b21NYXBTdHlsZSkge1xuICAgICAgICAvLyBzdHlsZSBub3QgeWV0IGxvYWRlZFxuICAgICAgICByZXR1cm4gPGRpdiAvPjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgbWFwUHJvcHMgPSB7XG4gICAgICAgIC4uLm1hcFN0YXRlLFxuICAgICAgICBwcmVzZXJ2ZURyYXdpbmdCdWZmZXI6IHRydWUsXG4gICAgICAgIG1hcGJveEFwaUFjY2Vzc1Rva2VuLFxuICAgICAgICBtYXBib3hBcGlVcmwsXG4gICAgICAgIG9uVmlld3BvcnRDaGFuZ2U6IHRoaXMuX29uVmlld3BvcnRDaGFuZ2UsXG4gICAgICAgIHRyYW5zZm9ybVJlcXVlc3RcbiAgICAgIH07XG5cbiAgICAgIHJldHVybiAoXG4gICAgICAgIDxTdHlsZWRNYXBDb250YWluZXIgc3R5bGU9e01BUF9TVFlMRS5jb250YWluZXJ9PlxuICAgICAgICAgIDxNYXBDb250cm9sXG4gICAgICAgICAgICBkYXRhc2V0cz17ZGF0YXNldHN9XG4gICAgICAgICAgICBkcmFnUm90YXRlPXttYXBTdGF0ZS5kcmFnUm90YXRlfVxuICAgICAgICAgICAgaXNTcGxpdD17Qm9vbGVhbihtYXBMYXllcnMpfVxuICAgICAgICAgICAgaXNFeHBvcnQ9e3RoaXMucHJvcHMuaXNFeHBvcnR9XG4gICAgICAgICAgICBsYXllcnM9e2xheWVyc31cbiAgICAgICAgICAgIGxheWVyc1RvUmVuZGVyPXtsYXllcnNUb1JlbmRlcn1cbiAgICAgICAgICAgIG1hcEluZGV4PXt0aGlzLnByb3BzLmluZGV4fVxuICAgICAgICAgICAgbWFwQ29udHJvbHM9e21hcENvbnRyb2xzfVxuICAgICAgICAgICAgcmVhZE9ubHk9e3RoaXMucHJvcHMucmVhZE9ubHl9XG4gICAgICAgICAgICBzY2FsZT17bWFwU3RhdGUuc2NhbGUgfHwgMX1cbiAgICAgICAgICAgIHRvcD17MH1cbiAgICAgICAgICAgIG9uVG9nZ2xlUGVyc3BlY3RpdmU9e21hcFN0YXRlQWN0aW9ucy50b2dnbGVQZXJzcGVjdGl2ZX1cbiAgICAgICAgICAgIG9uVG9nZ2xlU3BsaXRNYXA9e21hcFN0YXRlQWN0aW9ucy50b2dnbGVTcGxpdE1hcH1cbiAgICAgICAgICAgIG9uTWFwVG9nZ2xlTGF5ZXI9e3RoaXMuX2hhbmRsZU1hcFRvZ2dsZUxheWVyfVxuICAgICAgICAgICAgb25Ub2dnbGVNYXBDb250cm9sPXt0b2dnbGVNYXBDb250cm9sfVxuICAgICAgICAgIC8+XG4gICAgICAgICAgPE1hcENvbXBvbmVudFxuICAgICAgICAgICAgey4uLm1hcFByb3BzfVxuICAgICAgICAgICAga2V5PVwiYm90dG9tXCJcbiAgICAgICAgICAgIHJlZj17dGhpcy5fc2V0TWFwYm94TWFwfVxuICAgICAgICAgICAgbWFwU3R5bGU9e21hcFN0eWxlLmJvdHRvbU1hcFN0eWxlfVxuICAgICAgICAgICAgZ2V0Q3Vyc29yPXt0aGlzLnByb3BzLmhvdmVySW5mbyA/ICgpID0+ICdwb2ludGVyJyA6IHVuZGVmaW5lZH1cbiAgICAgICAgICAgIHRyYW5zaXRpb25EdXJhdGlvbj17VFJBTlNJVElPTl9EVVJBVElPTn1cbiAgICAgICAgICAgIG9uTW91c2VNb3ZlPXt0aGlzLnByb3BzLnZpc1N0YXRlQWN0aW9ucy5vbk1vdXNlTW92ZX1cbiAgICAgICAgICA+XG4gICAgICAgICAgICB7dGhpcy5fcmVuZGVyRGVja092ZXJsYXkobGF5ZXJzVG9SZW5kZXIpfVxuICAgICAgICAgICAge3RoaXMuX3JlbmRlck1hcGJveE92ZXJsYXlzKGxheWVyc1RvUmVuZGVyKX1cbiAgICAgICAgICA8L01hcENvbXBvbmVudD5cbiAgICAgICAgICB7bWFwU3R5bGUudG9wTWFwU3R5bGUgJiYgKFxuICAgICAgICAgICAgPGRpdiBzdHlsZT17TUFQX1NUWUxFLnRvcH0+XG4gICAgICAgICAgICAgIDxNYXBDb21wb25lbnRcbiAgICAgICAgICAgICAgICB7Li4ubWFwUHJvcHN9XG4gICAgICAgICAgICAgICAga2V5PVwidG9wXCJcbiAgICAgICAgICAgICAgICBtYXBTdHlsZT17bWFwU3R5bGUudG9wTWFwU3R5bGV9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICApfVxuICAgICAgICAgIHt0aGlzLl9yZW5kZXJNYXBQb3BvdmVyKGxheWVyc1RvUmVuZGVyKX1cbiAgICAgICAgPC9TdHlsZWRNYXBDb250YWluZXI+XG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBNYXBDb250YWluZXI7XG59XG4iXX0=