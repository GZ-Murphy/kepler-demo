"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _taggedTemplateLiteral2 = _interopRequireDefault(require("@babel/runtime/helpers/taggedTemplateLiteral"));

var _react = _interopRequireWildcard(require("react"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _fuzzy = _interopRequireDefault(require("fuzzy"));

var _classnames = _interopRequireDefault(require("classnames"));

var _styledComponents = _interopRequireDefault(require("styled-components"));

var _window = require("global/window");

var _accessor = _interopRequireDefault(require("./accessor"));

var _keyevent = _interopRequireDefault(require("./keyevent"));

var _dropdownList = _interopRequireWildcard(require("./dropdown-list"));

var _icons = require("../icons");

function _templateObject4() {
  var data = (0, _taggedTemplateLiteral2["default"])(["\n  position: absolute;\n  right: 15px;\n  top: 14px;\n  color: ", ";\n"]);

  _templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function _templateObject3() {
  var data = (0, _taggedTemplateLiteral2["default"])(["\n  ", "\n  :hover {\n    cursor: pointer;\n    background-color: ", ";\n  }\n"]);

  _templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function _templateObject2() {
  var data = (0, _taggedTemplateLiteral2["default"])(["\n  padding: 8px;\n"]);

  _templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function _templateObject() {
  var data = (0, _taggedTemplateLiteral2["default"])(["\n  display: flex;\n  flex-direction: column;\n  background-color: ", ";\n  box-shadow: ", ";\n\n  :focus {\n    outline: 0;\n  }\n"]);

  _templateObject = function _templateObject() {
    return data;
  };

  return data;
}

var DEFAULT_CLASS = 'typeahead';
/**
 * Copied mostly from 'react-typeahead', an auto-completing text input
 *
 * Renders an text input that shows options nearby that you can use the
 * keyboard or mouse to select.
 */

var TypeaheadWrapper = _styledComponents["default"].div(_templateObject(), function (props) {
  return props.theme.dropdownListBgd;
}, function (props) {
  return props.theme.dropdownListShadow;
});

var InputBox = _styledComponents["default"].div(_templateObject2());

var TypeaheadInput = _styledComponents["default"].input(_templateObject3(), function (props) {
  return props.theme.secondaryInput;
}, function (props) {
  return props.theme.secondaryInputBgd;
});

var InputIcon = _styledComponents["default"].div(_templateObject4(), function (props) {
  return props.theme.inputPlaceholderColor;
});

var Typeahead =
/*#__PURE__*/
function (_Component) {
  (0, _inherits2["default"])(Typeahead, _Component);

  function Typeahead(props) {
    var _this;

    (0, _classCallCheck2["default"])(this, Typeahead);
    _this = (0, _possibleConstructorReturn2["default"])(this, (0, _getPrototypeOf2["default"])(Typeahead).call(this, props));
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "root", (0, _react.createRef)());
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "entry", (0, _react.createRef)());
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_onOptionSelected", function (option, event) {
      if (_this.props.searchable) {
        // reset entry input
        _this.setState({
          searchResults: _this.getOptionsForValue('', _this.props.options),
          selection: '',
          entryValue: ''
        });
      }

      return _this.props.onOptionSelected(option, event);
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_onTextEntryUpdated", function () {
      if (_this.props.searchable) {
        var value = _this.entry.current.value;

        _this.setState({
          searchResults: _this.getOptionsForValue(value, _this.props.options),
          selection: '',
          entryValue: value
        });
      }
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_onEnter", function (event) {
      var selection = _this.getSelection();

      if (!selection) {
        return _this.props.onKeyDown(event);
      }

      return _this._onOptionSelected(selection, event);
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "navDown", function () {
      _this._nav(1);
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "navUp", function () {
      _this._nav(-1);
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_onChange", function (event) {
      if (_this.props.onChange) {
        _this.props.onChange(event);
      }

      _this._onTextEntryUpdated();
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_onKeyDown", function (event) {
      // If there are no visible elements, don't perform selector navigation.
      // Just pass this up to the upstream onKeydown handler.
      // Also skip if the user is pressing the shift key, since none of our handlers are looking for shift
      if (!_this._hasHint() || event.shiftKey) {
        return _this.props.onKeyDown(event);
      }

      var handler = _this.eventMap()[event.keyCode];

      if (handler) {
        handler(event);
      } else {
        return _this.props.onKeyDown(event);
      } // Don't propagate the keystroke back to the DOM/browser


      event.preventDefault();
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_onFocus", function (event) {
      _this.setState({
        isFocused: true
      });

      if (_this.props.onFocus) {
        return _this.props.onFocus(event);
      }
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_onBlur", function (event) {
      _this.setState({
        isFocused: false
      });

      if (_this.props.onBlur) {
        return _this.props.onBlur(event);
      }
    });
    _this.state = {
      searchResults: _this.getOptionsForValue(_this.props.initialValue, _this.props.options),
      // This should be called something else, 'entryValue'
      entryValue: _this.props.value || _this.props.initialValue,
      // A valid typeahead value
      selection: _this.props.value,
      // Index of the selection
      selectionIndex: null,
      // Keep track of the focus state of the input element, to determine
      // whether to show options when empty (if showOptionsWhenEmpty is true)
      isFocused: false
    };
    return _this;
  }

  (0, _createClass2["default"])(Typeahead, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      this.setState({
        searchResults: this.getOptionsForValue('', this.props.options)
      }); // call focus on entry or div to trigger key events listener

      if (this.entry.current) {
        this.entry.current.focus();
      } else {
        this.root.current.focus();
      }
    }
  }, {
    key: "componentWillReceiveProps",
    value: function componentWillReceiveProps(nextProps) {
      var searchResults = this.getOptionsForValue(this.state.entryValue, nextProps.options);
      this.setState({
        searchResults: searchResults
      });
    }
  }, {
    key: "_shouldSkipSearch",
    value: function _shouldSkipSearch(input) {
      var emptyValue = !input || input.trim().length === 0; // this.state must be checked because it may not be defined yet if this function
      // is called from within getInitialState

      var isFocused = this.state && this.state.isFocused;
      return !(this.props.showOptionsWhenEmpty && isFocused) && emptyValue;
    }
  }, {
    key: "getOptionsForValue",
    value: function getOptionsForValue(value, options) {
      if (!this.props.searchable) {
        // directly pass through options if can not be searched
        return options;
      }

      if (this._shouldSkipSearch(value)) {
        return options;
      }

      var searchOptions = this._generateSearchFunction();

      return searchOptions(value, options);
    }
  }, {
    key: "focus",
    value: function focus() {
      if (this.entry.current) {
        this.entry.current.focus();
      }
    }
  }, {
    key: "_hasCustomValue",
    value: function _hasCustomValue() {
      return this.props.allowCustomValues > 0 && this.state.entryValue.length >= this.props.allowCustomValues && this.state.searchResults.indexOf(this.state.entryValue) < 0;
    }
  }, {
    key: "_getCustomValue",
    value: function _getCustomValue() {
      return this._hasCustomValue() ? this.state.entryValue : null;
    }
  }, {
    key: "_renderIncrementalSearchResults",
    value: function _renderIncrementalSearchResults() {
      return _react["default"].createElement(this.props.customListComponent, {
        fixedOptions: this.props.fixedOptions,
        options: this.props.maxVisible ? this.state.searchResults.slice(0, this.props.maxVisible) : this.state.searchResults,
        areResultsTruncated: this.props.maxVisible && this.state.searchResults.length > this.props.maxVisible,
        resultsTruncatedMessage: this.props.resultsTruncatedMessage,
        onOptionSelected: this._onOptionSelected,
        allowCustomValues: this.props.allowCustomValues,
        customValue: this._getCustomValue(),
        customClasses: this.props.customClasses,
        customListItemComponent: this.props.customListItemComponent,
        customListHeaderComponent: this.props.customListHeaderComponent,
        selectionIndex: this.state.selectionIndex,
        defaultClassNames: this.props.defaultClassNames,
        displayOption: this.props.displayOption,
        selectedItems: this.props.selectedItems
      });
    }
  }, {
    key: "getSelection",
    value: function getSelection() {
      var index = this.state.selectionIndex;

      if (this._hasCustomValue()) {
        if (index === 0) {
          return this.state.entryValue;
        }

        index--;
      }

      if (this._hasFixedOptions()) {
        return index < this.props.fixedOptions.length ? this.props.fixedOptions[index] : this.state.searchResults[index - this.props.fixedOptions.length];
      }

      return this.state.searchResults[index];
    }
  }, {
    key: "_onEscape",
    value: function _onEscape() {
      this.setState({
        selectionIndex: null
      });
    }
  }, {
    key: "_onTab",
    value: function _onTab(event) {
      var selection = this.getSelection();
      var option = selection ? selection : this.state.searchResults.length > 0 ? this.state.searchResults[0] : null;

      if (option === null && this._hasCustomValue()) {
        option = this._getCustomValue();
      }

      if (option !== null) {
        return this._onOptionSelected(option, event);
      }
    }
  }, {
    key: "eventMap",
    value: function eventMap(event) {
      var events = {};
      events[_keyevent["default"].DOM_VK_UP] = this.navUp;
      events[_keyevent["default"].DOM_VK_DOWN] = this.navDown;
      events[_keyevent["default"].DOM_VK_RETURN] = events[_keyevent["default"].DOM_VK_ENTER] = this._onEnter;
      events[_keyevent["default"].DOM_VK_ESCAPE] = this._onEscape;
      events[_keyevent["default"].DOM_VK_TAB] = this._onTab;
      return events;
    }
  }, {
    key: "_nav",
    value: function _nav(delta) {
      if (!this._hasHint()) {
        return;
      }

      var newIndex = this.state.selectionIndex === null ? delta === 1 ? 0 : delta : this.state.selectionIndex + delta;
      var length = this.props.maxVisible ? this.state.searchResults.slice(0, this.props.maxVisible).length : this.state.searchResults.length;

      if (this._hasCustomValue()) {
        length += 1;
      }

      if (newIndex < 0) {
        newIndex += length;
      } else if (newIndex >= length) {
        newIndex -= length;
      }

      this.setState({
        selectionIndex: newIndex
      });
    }
  }, {
    key: "_renderHiddenInput",
    value: function _renderHiddenInput() {
      if (!this.props.name) {
        return null;
      }

      return _react["default"].createElement("input", {
        type: "hidden",
        name: this.props.name,
        value: this.state.selection
      });
    }
  }, {
    key: "_generateSearchFunction",
    value: function _generateSearchFunction() {
      var searchOptionsProp = this.props.searchOptions;
      var filterOptionProp = this.props.filterOption;

      if (typeof searchOptionsProp === 'function') {
        if (filterOptionProp !== null) {
          _window.console.warn('searchOptions prop is being used, filterOption prop will be ignored');
        }

        return searchOptionsProp;
      } else if (typeof filterOptionProp === 'function') {
        // use custom filter option
        return function (value, options) {
          return options.filter(function (o) {
            return filterOptionProp(value, o);
          });
        };
      }

      var mapper = typeof filterOptionProp === 'string' ? _accessor["default"].generateAccessor(filterOptionProp) : _accessor["default"].IDENTITY_FN;
      return function (value, options) {
        return _fuzzy["default"].filter(value, options, {
          extract: mapper
        }).map(function (res) {
          return options[res.index];
        });
      };
    }
  }, {
    key: "_hasHint",
    value: function _hasHint() {
      return this.state.searchResults.length > 0 || this._hasCustomValue();
    }
  }, {
    key: "_hasFixedOptions",
    value: function _hasFixedOptions() {
      return Array.isArray(this.props.fixedOptions) && this.props.fixedOptions.length;
    }
  }, {
    key: "render",
    value: function render() {
      var inputClasses = {};
      inputClasses[this.props.customClasses.input] = Boolean(this.props.customClasses.input);
      var inputClassList = (0, _classnames["default"])(inputClasses);
      var classes = (0, _defineProperty2["default"])({}, DEFAULT_CLASS, this.props.defaultClassNames);
      classes[this.props.className] = Boolean(this.props.className);
      var classList = (0, _classnames["default"])(classes);
      return _react["default"].createElement(TypeaheadWrapper, {
        className: classList,
        ref: this.root,
        tabIndex: "0",
        onKeyDown: this._onKeyDown,
        onKeyPress: this.props.onKeyPress,
        onKeyUp: this.props.onKeyUp,
        onFocus: this._onFocus
      }, this._renderHiddenInput(), this.props.searchable ? _react["default"].createElement(InputBox, null, _react["default"].createElement(TypeaheadInput, (0, _extends2["default"])({
        ref: this.entry,
        type: "text",
        disabled: this.props.disabled
      }, this.props.inputProps, {
        placeholder: this.props.placeholder,
        className: inputClassList,
        value: this.state.entryValue,
        onChange: this._onChange,
        onBlur: this._onBlur
      })), _react["default"].createElement(InputIcon, null, _react["default"].createElement(_icons.Search, {
        height: "18px"
      }))) : null, this._renderIncrementalSearchResults());
    }
  }]);
  return Typeahead;
}(_react.Component);

exports["default"] = Typeahead;
(0, _defineProperty2["default"])(Typeahead, "propTypes", {
  name: _propTypes["default"].string,
  customClasses: _propTypes["default"].object,
  maxVisible: _propTypes["default"].number,
  resultsTruncatedMessage: _propTypes["default"].string,
  options: _propTypes["default"].arrayOf(_propTypes["default"].any),
  fixedOptions: _propTypes["default"].arrayOf(_propTypes["default"].any),
  allowCustomValues: _propTypes["default"].number,
  initialValue: _propTypes["default"].string,
  value: _propTypes["default"].string,
  placeholder: _propTypes["default"].string,
  disabled: _propTypes["default"].bool,
  textarea: _propTypes["default"].bool,
  inputProps: _propTypes["default"].object,
  onOptionSelected: _propTypes["default"].func,
  onChange: _propTypes["default"].func,
  onKeyDown: _propTypes["default"].func,
  onKeyPress: _propTypes["default"].func,
  onKeyUp: _propTypes["default"].func,
  onFocus: _propTypes["default"].func,
  onBlur: _propTypes["default"].func,
  filterOption: _propTypes["default"].oneOfType([_propTypes["default"].string, _propTypes["default"].func]),
  searchOptions: _propTypes["default"].func,
  displayOption: _propTypes["default"].oneOfType([_propTypes["default"].string, _propTypes["default"].func]),
  inputDisplayOption: _propTypes["default"].oneOfType([_propTypes["default"].string, _propTypes["default"].func]),
  formInputOption: _propTypes["default"].oneOfType([_propTypes["default"].string, _propTypes["default"].func]),
  defaultClassNames: _propTypes["default"].bool,
  customListComponent: _propTypes["default"].oneOfType([_propTypes["default"].element, _propTypes["default"].func]),
  customListItemComponent: _propTypes["default"].oneOfType([_propTypes["default"].element, _propTypes["default"].func]),
  customListHeaderComponent: _propTypes["default"].oneOfType([_propTypes["default"].element, _propTypes["default"].func]),
  showOptionsWhenEmpty: _propTypes["default"].bool,
  searchable: _propTypes["default"].bool
});
(0, _defineProperty2["default"])(Typeahead, "defaultProps", {
  options: [],
  customClasses: {},
  allowCustomValues: 0,
  initialValue: '',
  value: '',
  placeholder: '',
  disabled: false,
  textarea: false,
  inputProps: {},
  onOptionSelected: function onOptionSelected(option) {},
  onChange: function onChange(event) {},
  onKeyDown: function onKeyDown(event) {},
  onKeyPress: function onKeyPress(event) {},
  onKeyUp: function onKeyUp(event) {},
  onFocus: function onFocus(event) {},
  onBlur: function onBlur(event) {},
  filterOption: null,
  searchOptions: null,
  inputDisplayOption: null,
  defaultClassNames: true,
  customListComponent: _dropdownList["default"],
  customListItemComponent: _dropdownList.ListItem,
  customListHeaderComponent: null,
  showOptionsWhenEmpty: true,
  searchable: true,
  resultsTruncatedMessage: null
});
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL2NvbW1vbi9pdGVtLXNlbGVjdG9yL3R5cGVhaGVhZC5qcyJdLCJuYW1lcyI6WyJERUZBVUxUX0NMQVNTIiwiVHlwZWFoZWFkV3JhcHBlciIsInN0eWxlZCIsImRpdiIsInByb3BzIiwidGhlbWUiLCJkcm9wZG93bkxpc3RCZ2QiLCJkcm9wZG93bkxpc3RTaGFkb3ciLCJJbnB1dEJveCIsIlR5cGVhaGVhZElucHV0IiwiaW5wdXQiLCJzZWNvbmRhcnlJbnB1dCIsInNlY29uZGFyeUlucHV0QmdkIiwiSW5wdXRJY29uIiwiaW5wdXRQbGFjZWhvbGRlckNvbG9yIiwiVHlwZWFoZWFkIiwib3B0aW9uIiwiZXZlbnQiLCJzZWFyY2hhYmxlIiwic2V0U3RhdGUiLCJzZWFyY2hSZXN1bHRzIiwiZ2V0T3B0aW9uc0ZvclZhbHVlIiwib3B0aW9ucyIsInNlbGVjdGlvbiIsImVudHJ5VmFsdWUiLCJvbk9wdGlvblNlbGVjdGVkIiwidmFsdWUiLCJlbnRyeSIsImN1cnJlbnQiLCJnZXRTZWxlY3Rpb24iLCJvbktleURvd24iLCJfb25PcHRpb25TZWxlY3RlZCIsIl9uYXYiLCJvbkNoYW5nZSIsIl9vblRleHRFbnRyeVVwZGF0ZWQiLCJfaGFzSGludCIsInNoaWZ0S2V5IiwiaGFuZGxlciIsImV2ZW50TWFwIiwia2V5Q29kZSIsInByZXZlbnREZWZhdWx0IiwiaXNGb2N1c2VkIiwib25Gb2N1cyIsIm9uQmx1ciIsInN0YXRlIiwiaW5pdGlhbFZhbHVlIiwic2VsZWN0aW9uSW5kZXgiLCJmb2N1cyIsInJvb3QiLCJuZXh0UHJvcHMiLCJlbXB0eVZhbHVlIiwidHJpbSIsImxlbmd0aCIsInNob3dPcHRpb25zV2hlbkVtcHR5IiwiX3Nob3VsZFNraXBTZWFyY2giLCJzZWFyY2hPcHRpb25zIiwiX2dlbmVyYXRlU2VhcmNoRnVuY3Rpb24iLCJhbGxvd0N1c3RvbVZhbHVlcyIsImluZGV4T2YiLCJfaGFzQ3VzdG9tVmFsdWUiLCJmaXhlZE9wdGlvbnMiLCJtYXhWaXNpYmxlIiwic2xpY2UiLCJyZXN1bHRzVHJ1bmNhdGVkTWVzc2FnZSIsIl9nZXRDdXN0b21WYWx1ZSIsImN1c3RvbUNsYXNzZXMiLCJjdXN0b21MaXN0SXRlbUNvbXBvbmVudCIsImN1c3RvbUxpc3RIZWFkZXJDb21wb25lbnQiLCJkZWZhdWx0Q2xhc3NOYW1lcyIsImRpc3BsYXlPcHRpb24iLCJzZWxlY3RlZEl0ZW1zIiwiaW5kZXgiLCJfaGFzRml4ZWRPcHRpb25zIiwiZXZlbnRzIiwiS2V5RXZlbnQiLCJET01fVktfVVAiLCJuYXZVcCIsIkRPTV9WS19ET1dOIiwibmF2RG93biIsIkRPTV9WS19SRVRVUk4iLCJET01fVktfRU5URVIiLCJfb25FbnRlciIsIkRPTV9WS19FU0NBUEUiLCJfb25Fc2NhcGUiLCJET01fVktfVEFCIiwiX29uVGFiIiwiZGVsdGEiLCJuZXdJbmRleCIsIm5hbWUiLCJzZWFyY2hPcHRpb25zUHJvcCIsImZpbHRlck9wdGlvblByb3AiLCJmaWx0ZXJPcHRpb24iLCJDb25zb2xlIiwid2FybiIsImZpbHRlciIsIm8iLCJtYXBwZXIiLCJBY2Nlc3NvciIsImdlbmVyYXRlQWNjZXNzb3IiLCJJREVOVElUWV9GTiIsImZ1enp5IiwiZXh0cmFjdCIsIm1hcCIsInJlcyIsIkFycmF5IiwiaXNBcnJheSIsImlucHV0Q2xhc3NlcyIsIkJvb2xlYW4iLCJpbnB1dENsYXNzTGlzdCIsImNsYXNzZXMiLCJjbGFzc05hbWUiLCJjbGFzc0xpc3QiLCJfb25LZXlEb3duIiwib25LZXlQcmVzcyIsIm9uS2V5VXAiLCJfb25Gb2N1cyIsIl9yZW5kZXJIaWRkZW5JbnB1dCIsImRpc2FibGVkIiwiaW5wdXRQcm9wcyIsInBsYWNlaG9sZGVyIiwiX29uQ2hhbmdlIiwiX29uQmx1ciIsIl9yZW5kZXJJbmNyZW1lbnRhbFNlYXJjaFJlc3VsdHMiLCJDb21wb25lbnQiLCJQcm9wVHlwZXMiLCJzdHJpbmciLCJvYmplY3QiLCJudW1iZXIiLCJhcnJheU9mIiwiYW55IiwiYm9vbCIsInRleHRhcmVhIiwiZnVuYyIsIm9uZU9mVHlwZSIsImlucHV0RGlzcGxheU9wdGlvbiIsImZvcm1JbnB1dE9wdGlvbiIsImN1c3RvbUxpc3RDb21wb25lbnQiLCJlbGVtZW50IiwiRHJvcGRvd25MaXN0IiwiTGlzdEl0ZW0iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBb0JBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUVBOztBQUNBOztBQUNBOztBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFQSxJQUFNQSxhQUFhLEdBQUcsV0FBdEI7QUFDQTs7Ozs7OztBQU9BLElBQU1DLGdCQUFnQixHQUFHQyw2QkFBT0MsR0FBVixvQkFHQSxVQUFBQyxLQUFLO0FBQUEsU0FBSUEsS0FBSyxDQUFDQyxLQUFOLENBQVlDLGVBQWhCO0FBQUEsQ0FITCxFQUlOLFVBQUFGLEtBQUs7QUFBQSxTQUFJQSxLQUFLLENBQUNDLEtBQU4sQ0FBWUUsa0JBQWhCO0FBQUEsQ0FKQyxDQUF0Qjs7QUFXQSxJQUFNQyxRQUFRLEdBQUdOLDZCQUFPQyxHQUFWLG9CQUFkOztBQUlBLElBQU1NLGNBQWMsR0FBR1AsNkJBQU9RLEtBQVYscUJBQ2hCLFVBQUFOLEtBQUs7QUFBQSxTQUFJQSxLQUFLLENBQUNDLEtBQU4sQ0FBWU0sY0FBaEI7QUFBQSxDQURXLEVBSUksVUFBQVAsS0FBSztBQUFBLFNBQUlBLEtBQUssQ0FBQ0MsS0FBTixDQUFZTyxpQkFBaEI7QUFBQSxDQUpULENBQXBCOztBQVFBLElBQU1DLFNBQVMsR0FBR1gsNkJBQU9DLEdBQVYscUJBSUosVUFBQUMsS0FBSztBQUFBLFNBQUlBLEtBQUssQ0FBQ0MsS0FBTixDQUFZUyxxQkFBaEI7QUFBQSxDQUpELENBQWY7O0lBT3FCQyxTOzs7OztBQXNFbkIscUJBQVlYLEtBQVosRUFBbUI7QUFBQTs7QUFBQTtBQUNqQixxSEFBTUEsS0FBTjtBQURpQiw2RkE4Q1osdUJBOUNZO0FB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QU9wQkYsRUFBQUEsUUFBUSxFQUFFLEtBUFU7QUFRcEJjLEVBQUFBLFFBQVEsRUFBRSxLQVJVO0FBU3BCYixFQUFBQSxVQUFVLEVBQUUsRUFUUTtBQVVwQjdGLEVBQUFBLGdCQVZvQiw0QkFVSFQsTUFWRyxFQVVLLENBQUUsQ0FWUDtBQVdwQmlCLEVBQUFBLFFBWG9CLG9CQVdYaEIsS0FYVyxFQVdKLENBQUUsQ0FYRTtBQVlwQmEsRUFBQUEsU0Fab0IscUJBWVZiLEtBWlUsRUFZSCxDQUFFLENBWkM7QUFhcEJnRyxFQUFBQSxVQWJvQixzQkFhVGhHLEtBYlMsRUFhRixDQUFFLENBYkE7QUFjcEJpRyxFQUFBQSxPQWRvQixtQkFjWmpHLEtBZFksRUFjTCxDQUFFLENBZEc7QUFlcEJ5QixFQUFBQSxPQWZvQixtQkFlWnpCLEtBZlksRUFlTCxDQUFFLENBZkc7QUFnQnBCMEIsRUFBQUEsTUFoQm9CLGtCQWdCYjFCLEtBaEJhLEVBZ0JOLENBQUUsQ0FoQkk7QUFpQnBCMEUsRUFBQUEsWUFBWSxFQUFFLElBakJNO0FBa0JwQnBDLEVBQUFBLGFBQWEsRUFBRSxJQWxCSztBQW1CcEIrRSxFQUFBQSxrQkFBa0IsRUFBRSxJQW5CQTtBQW9CcEJsRSxFQUFBQSxpQkFBaUIsRUFBRSxJQXBCQztBQXFCcEJvRSxFQUFBQSxtQkFBbUIsRUFBRUUsd0JBckJEO0FBc0JwQnhFLEVBQUFBLHVCQUF1QixFQUFFeUUsc0JBdEJMO0FBdUJwQnhFLEVBQUFBLHlCQUF5QixFQUFFLElBdkJQO0FBd0JwQmQsRUFBQUEsb0JBQW9CLEVBQUUsSUF4QkY7QUF5QnBCbkMsRUFBQUEsVUFBVSxFQUFFLElBekJRO0FBMEJwQjZDLEVBQUFBLHVCQUF1QixFQUFFO0FBMUJMLEM7QUFvWnZCIiwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IChjKSAyMDE5IFViZXIgVGVjaG5vbG9naWVzLCBJbmMuXG4vL1xuLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuLy8gb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuLy8gaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuLy8gdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuLy8gY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4vLyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4vLyBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbi8vXG4vLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4vLyBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbi8vIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuLy8gQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuLy8gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbi8vIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbi8vIFRIRSBTT0ZUV0FSRS5cblxuaW1wb3J0IFJlYWN0LCB7Q29tcG9uZW50LCBjcmVhdGVSZWZ9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5pbXBvcnQgZnV6enkgZnJvbSAnZnV6enknO1xuaW1wb3J0IGNsYXNzTmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7XG5pbXBvcnQgc3R5bGVkIGZyb20gJ3N0eWxlZC1jb21wb25lbnRzJztcbmltcG9ydCB7Y29uc29sZSBhcyBDb25zb2xlfSBmcm9tICdnbG9iYWwvd2luZG93JztcblxuaW1wb3J0IEFjY2Vzc29yIGZyb20gJy4vYWNjZXNzb3InO1xuaW1wb3J0IEtleUV2ZW50IGZyb20gJy4va2V5ZXZlbnQnO1xuaW1wb3J0IERyb3Bkb3duTGlzdCwge0xpc3RJdGVtfSBmcm9tICcuL2Ryb3Bkb3duLWxpc3QnO1xuaW1wb3J0IHtTZWFyY2h9IGZyb20gJ2NvbXBvbmVudHMvY29tbW9uL2ljb25zJztcblxuY29uc3QgREVGQVVMVF9DTEFTUyA9ICd0eXBlYWhlYWQnO1xuLyoqXG4gKiBDb3BpZWQgbW9zdGx5IGZyb20gJ3JlYWN0LXR5cGVhaGVhZCcsIGFuIGF1dG8tY29tcGxldGluZyB0ZXh0IGlucHV0XG4gKlxuICogUmVuZGVycyBhbiB0ZXh0IGlucHV0IHRoYXQgc2hvd3Mgb3B0aW9ucyBuZWFyYnkgdGhhdCB5b3UgY2FuIHVzZSB0aGVcbiAqIGtleWJvYXJkIG9yIG1vdXNlIHRvIHNlbGVjdC5cbiAqL1xuXG5jb25zdCBUeXBlYWhlYWRXcmFwcGVyID0gc3R5bGVkLmRpdmBcbiAgZGlzcGxheTogZmxleDtcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgYmFja2dyb3VuZC1jb2xvcjogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5kcm9wZG93bkxpc3RCZ2R9O1xuICBib3gtc2hhZG93OiAke3Byb3BzID0+IHByb3BzLnRoZW1lLmRyb3Bkb3duTGlzdFNoYWRvd307XG5cbiAgOmZvY3VzIHtcbiAgICBvdXRsaW5lOiAwO1xuICB9XG5gO1xuXG5jb25zdCBJbnB1dEJveCA9IHN0eWxlZC5kaXZgXG4gIHBhZGRpbmc6IDhweDtcbmA7XG5cbmNvbnN0IFR5cGVhaGVhZElucHV0ID0gc3R5bGVkLmlucHV0YFxuICAke3Byb3BzID0+IHByb3BzLnRoZW1lLnNlY29uZGFyeUlucHV0fVxuICA6aG92ZXIge1xuICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAke3Byb3BzID0+IHByb3BzLnRoZW1lLnNlY29uZGFyeUlucHV0QmdkfTtcbiAgfVxuYDtcblxuY29uc3QgSW5wdXRJY29uID0gc3R5bGVkLmRpdmBcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICByaWdodDogMTVweDtcbiAgdG9wOiAxNHB4O1xuICBjb2xvcjogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5pbnB1dFBsYWNlaG9sZGVyQ29sb3J9O1xuYDtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVHlwZWFoZWFkIGV4dGVuZHMgQ29tcG9uZW50IHtcbiAgc3RhdGljIHByb3BUeXBlcyA9IHtcbiAgICBuYW1lOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIGN1c3RvbUNsYXNzZXM6IFByb3BUeXBlcy5vYmplY3QsXG4gICAgbWF4VmlzaWJsZTogUHJvcFR5cGVzLm51bWJlcixcbiAgICByZXN1bHRzVHJ1bmNhdGVkTWVzc2FnZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgICBvcHRpb25zOiBQcm9wVHlwZXMuYXJyYXlPZihQcm9wVHlwZXMuYW55KSxcbiAgICBmaXhlZE9wdGlvbnM6IFByb3BUeXBlcy5hcnJheU9mKFByb3BUeXBlcy5hbnkpLFxuICAgIGFsbG93Q3VzdG9tVmFsdWVzOiBQcm9wVHlwZXMubnVtYmVyLFxuICAgIGluaXRpYWxWYWx1ZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgICB2YWx1ZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgICBwbGFjZWhvbGRlcjogUHJvcFR5cGVzLnN0cmluZyxcbiAgICBkaXNhYmxlZDogUHJvcFR5cGVzLmJvb2wsXG4gICAgdGV4dGFyZWE6IFByb3BUeXBlcy5ib29sLFxuICAgIGlucHV0UHJvcHM6IFByb3BUeXBlcy5vYmplY3QsXG4gICAgb25PcHRpb25TZWxlY3RlZDogUHJvcFR5cGVzLmZ1bmMsXG4gICAgb25DaGFuZ2U6IFByb3BUeXBlcy5mdW5jLFxuICAgIG9uS2V5RG93bjogUHJvcFR5cGVzLmZ1bmMsXG4gICAgb25LZXlQcmVzczogUHJvcFR5cGVzLmZ1bmMsXG4gICAgb25LZXlVcDogUHJvcFR5cGVzLmZ1bmMsXG4gICAgb25Gb2N1czogUHJvcFR5cGVzLmZ1bmMsXG4gICAgb25CbHVyOiBQcm9wVHlwZXMuZnVuYyxcbiAgICBmaWx0ZXJPcHRpb246IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5zdHJpbmcsIFByb3BUeXBlcy5mdW5jXSksXG4gICAgc2VhcmNoT3B0aW9uczogUHJvcFR5cGVzLmZ1bmMsXG4gICAgZGlzcGxheU9wdGlvbjogUHJvcFR5cGVzLm9uZU9mVHlwZShbUHJvcFR5cGVzLnN0cmluZywgUHJvcFR5cGVzLmZ1bmNdKSxcbiAgICBpbnB1dERpc3BsYXlPcHRpb246IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5zdHJpbmcsIFByb3BUeXBlcy5mdW5jXSksXG4gICAgZm9ybUlucHV0T3B0aW9uOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuc3RyaW5nLCBQcm9wVHlwZXMuZnVuY10pLFxuICAgIGRlZmF1bHRDbGFzc05hbWVzOiBQcm9wVHlwZXMuYm9vbCxcbiAgICBjdXN0b21MaXN0Q29tcG9uZW50OiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuZWxlbWVudCwgUHJvcFR5cGVzLmZ1bmNdKSxcbiAgICBjdXN0b21MaXN0SXRlbUNvbXBvbmVudDogUHJvcFR5cGVzLm9uZU9mVHlwZShbXG4gICAgICBQcm9wVHlwZXMuZWxlbWVudCxcbiAgICAgIFByb3BUeXBlcy5mdW5jXG4gICAgXSksXG4gICAgY3VzdG9tTGlzdEhlYWRlckNvbXBvbmVudDogUHJvcFR5cGVzLm9uZU9mVHlwZShbXG4gICAgICBQcm9wVHlwZXMuZWxlbWVudCxcbiAgICAgIFByb3BUeXBlcy5mdW5jXG4gICAgXSksXG4gICAgc2hvd09wdGlvbnNXaGVuRW1wdHk6IFByb3BUeXBlcy5ib29sLFxuICAgIHNlYXJjaGFibGU6IFByb3BUeXBlcy5ib29sXG4gIH07XG5cbiAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICBvcHRpb25zOiBbXSxcbiAgICBjdXN0b21DbGFzc2VzOiB7fSxcbiAgICBhbGxvd0N1c3RvbVZhbHVlczogMCxcbiAgICBpbml0aWFsVmFsdWU6ICcnLFxuICAgIHZhbHVlOiAnJyxcbiAgICBwbGFjZWhvbGRlcjogJycsXG4gICAgZGlzYWJsZWQ6IGZhbHNlLFxuICAgIHRleHRhcmVhOiBmYWxzZSxcbiAgICBpbnB1dFByb3BzOiB7fSxcbiAgICBvbk9wdGlvblNlbGVjdGVkKG9wdGlvbikge30sXG4gICAgb25DaGFuZ2UoZXZlbnQpIHt9LFxuICAgIG9uS2V5RG93bihldmVudCkge30sXG4gICAgb25LZXlQcmVzcyhldmVudCkge30sXG4gICAgb25LZXlVcChldmVudCkge30sXG4gICAgb25Gb2N1cyhldmVudCkge30sXG4gICAgb25CbHVyKGV2ZW50KSB7fSxcbiAgICBmaWx0ZXJPcHRpb246IG51bGwsXG4gICAgc2VhcmNoT3B0aW9uczogbnVsbCxcbiAgICBpbnB1dERpc3BsYXlPcHRpb246IG51bGwsXG4gICAgZGVmYXVsdENsYXNzTmFtZXM6IHRydWUsXG4gICAgY3VzdG9tTGlzdENvbXBvbmVudDogRHJvcGRvd25MaXN0LFxuICAgIGN1c3RvbUxpc3RJdGVtQ29tcG9uZW50OiBMaXN0SXRlbSxcbiAgICBjdXN0b21MaXN0SGVhZGVyQ29tcG9uZW50OiBudWxsLFxuICAgIHNob3dPcHRpb25zV2hlbkVtcHR5OiB0cnVlLFxuICAgIHNlYXJjaGFibGU6IHRydWUsXG4gICAgcmVzdWx0c1RydW5jYXRlZE1lc3NhZ2U6IG51bGxcbiAgfTtcblxuICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcblxuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBzZWFyY2hSZXN1bHRzOiB0aGlzLmdldE9wdGlvbnNGb3JWYWx1ZShcbiAgICAgICAgdGhpcy5wcm9wcy5pbml0aWFsVmFsdWUsXG4gICAgICAgIHRoaXMucHJvcHMub3B0aW9uc1xuICAgICAgKSxcblxuICAgICAgLy8gVGhpcyBzaG91bGQgYmUgY2FsbGVkIHNvbWV0aGluZyBlbHNlLCAnZW50cnlWYWx1ZSdcbiAgICAgIGVudHJ5VmFsdWU6IHRoaXMucHJvcHMudmFsdWUgfHwgdGhpcy5wcm9wcy5pbml0aWFsVmFsdWUsXG5cbiAgICAgIC8vIEEgdmFsaWQgdHlwZWFoZWFkIHZhbHVlXG4gICAgICBzZWxlY3Rpb246IHRoaXMucHJvcHMudmFsdWUsXG5cbiAgICAgIC8vIEluZGV4IG9mIHRoZSBzZWxlY3Rpb25cbiAgICAgIHNlbGVjdGlvbkluZGV4OiBudWxsLFxuXG4gICAgICAvLyBLZWVwIHRyYWNrIG9mIHRoZSBmb2N1cyBzdGF0ZSBvZiB0aGUgaW5wdXQgZWxlbWVudCwgdG8gZGV0ZXJtaW5lXG4gICAgICAvLyB3aGV0aGVyIHRvIHNob3cgb3B0aW9ucyB3aGVuIGVtcHR5IChpZiBzaG93T3B0aW9uc1doZW5FbXB0eSBpcyB0cnVlKVxuICAgICAgaXNGb2N1c2VkOiBmYWxzZVxuICAgIH07XG4gIH1cblxuICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgIHNlYXJjaFJlc3VsdHM6IHRoaXMuZ2V0T3B0aW9uc0ZvclZhbHVlKCcnLCB0aGlzLnByb3BzLm9wdGlvbnMpXG4gICAgfSk7XG5cbiAgICAvLyBjYWxsIGZvY3VzIG9uIGVudHJ5IG9yIGRpdiB0byB0cmlnZ2VyIGtleSBldmVudHMgbGlzdGVuZXJcbiAgICBpZiAodGhpcy5lbnRyeS5jdXJyZW50KSB7XG4gICAgICB0aGlzLmVudHJ5LmN1cnJlbnQuZm9jdXMoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5yb290LmN1cnJlbnQuZm9jdXMoKTtcbiAgICB9XG4gIH1cblxuICBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKG5leHRQcm9wcykge1xuICAgIGNvbnN0IHNlYXJjaFJlc3VsdHMgPSB0aGlzLmdldE9wdGlvbnNGb3JWYWx1ZShcbiAgICAgIHRoaXMuc3RhdGUuZW50cnlWYWx1ZSxcbiAgICAgIG5leHRQcm9wcy5vcHRpb25zXG4gICAgKTtcblxuICAgIHRoaXMuc2V0U3RhdGUoe3NlYXJjaFJlc3VsdHN9KTtcbiAgfVxuXG4gIHJvb3QgPSBjcmVhdGVSZWYoKTtcbiAgZW50cnkgPSBjcmVhdGVSZWYoKTtcblxuICBfc2hvdWxkU2tpcFNlYXJjaChpbnB1dCkge1xuICAgIGNvbnN0IGVtcHR5VmFsdWUgPSAhaW5wdXQgfHwgaW5wdXQudHJpbSgpLmxlbmd0aCA9PT0gMDtcblxuICAgIC8vIHRoaXMuc3RhdGUgbXVzdCBiZSBjaGVja2VkIGJlY2F1c2UgaXQgbWF5IG5vdCBiZSBkZWZpbmVkIHlldCBpZiB0aGlzIGZ1bmN0aW9uXG4gICAgLy8gaXMgY2FsbGVkIGZyb20gd2l0aGluIGdldEluaXRpYWxTdGF0ZVxuICAgIGNvbnN0IGlzRm9jdXNlZCA9IHRoaXMuc3RhdGUgJiYgdGhpcy5zdGF0ZS5pc0ZvY3VzZWQ7XG4gICAgcmV0dXJuICEodGhpcy5wcm9wcy5zaG93T3B0aW9uc1doZW5FbXB0eSAmJiBpc0ZvY3VzZWQpICYmIGVtcHR5VmFsdWU7XG4gIH1cblxuICBnZXRPcHRpb25zRm9yVmFsdWUodmFsdWUsIG9wdGlvbnMpIHtcbiAgICBpZiAoIXRoaXMucHJvcHMuc2VhcmNoYWJsZSkge1xuICAgICAgLy8gZGlyZWN0bHkgcGFzcyB0aHJvdWdoIG9wdGlvbnMgaWYgY2FuIG5vdCBiZSBzZWFyY2hlZFxuICAgICAgcmV0dXJuIG9wdGlvbnM7XG4gICAgfVxuICAgIGlmICh0aGlzLl9zaG91bGRTa2lwU2VhcmNoKHZhbHVlKSkge1xuICAgICAgcmV0dXJuIG9wdGlvbnM7XG4gICAgfVxuXG4gICAgY29uc3Qgc2VhcmNoT3B0aW9ucyA9IHRoaXMuX2dlbmVyYXRlU2VhcmNoRnVuY3Rpb24oKTtcbiAgICByZXR1cm4gc2VhcmNoT3B0aW9ucyh2YWx1ZSwgb3B0aW9ucyk7XG4gIH1cblxuICBmb2N1cygpIHtcbiAgICBpZiAodGhpcy5lbnRyeS5jdXJyZW50KSB7XG4gICAgICB0aGlzLmVudHJ5LmN1cnJlbnQuZm9jdXMoKTtcbiAgICB9XG4gIH1cblxuICBfaGFzQ3VzdG9tVmFsdWUoKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIHRoaXMucHJvcHMuYWxsb3dDdXN0b21WYWx1ZXMgPiAwICYmXG4gICAgICB0aGlzLnN0YXRlLmVudHJ5VmFsdWUubGVuZ3RoID49IHRoaXMucHJvcHMuYWxsb3dDdXN0b21WYWx1ZXMgJiZcbiAgICAgIHRoaXMuc3RhdGUuc2VhcmNoUmVzdWx0cy5pbmRleE9mKHRoaXMuc3RhdGUuZW50cnlWYWx1ZSkgPCAwXG4gICAgKTtcbiAgfVxuXG4gIF9nZXRDdXN0b21WYWx1ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5faGFzQ3VzdG9tVmFsdWUoKSA/IHRoaXMuc3RhdGUuZW50cnlWYWx1ZSA6IG51bGw7XG4gIH1cblxuICBfcmVuZGVySW5jcmVtZW50YWxTZWFyY2hSZXN1bHRzKCkge1xuICAgIHJldHVybiAoXG4gICAgICA8dGhpcy5wcm9wcy5jdXN0b21MaXN0Q29tcG9uZW50XG4gICAgICAgIGZpeGVkT3B0aW9ucz17dGhpcy5wcm9wcy5maXhlZE9wdGlvbnN9XG4gICAgICAgIG9wdGlvbnM9e1xuICAgICAgICAgIHRoaXMucHJvcHMubWF4VmlzaWJsZVxuICAgICAgICAgICAgPyB0aGlzLnN0YXRlLnNlYXJjaFJlc3VsdHMuc2xpY2UoMCwgdGhpcy5wcm9wcy5tYXhWaXNpYmxlKVxuICAgICAgICAgICAgOiB0aGlzLnN0YXRlLnNlYXJjaFJlc3VsdHNcbiAgICAgICAgfVxuICAgICAgICBhcmVSZXN1bHRzVHJ1bmNhdGVkPXtcbiAgICAgICAgICB0aGlzLnByb3BzLm1heFZpc2libGUgJiZcbiAgICAgICAgICB0aGlzLnN0YXRlLnNlYXJjaFJlc3VsdHMubGVuZ3RoID4gdGhpcy5wcm9wcy5tYXhWaXNpYmxlXG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0c1RydW5jYXRlZE1lc3NhZ2U9e3RoaXMucHJvcHMucmVzdWx0c1RydW5jYXRlZE1lc3NhZ2V9XG4gICAgICAgIG9uT3B0aW9uU2VsZWN0ZWQ9e3RoaXMuX29uT3B0aW9uU2VsZWN0ZWR9XG4gICAgICAgIGFsbG93Q3VzdG9tVmFsdWVzPXt0aGlzLnByb3BzLmFsbG93Q3VzdG9tVmFsdWVzfVxuICAgICAgICBjdXN0b21WYWx1ZT17dGhpcy5fZ2V0Q3VzdG9tVmFsdWUoKX1cbiAgICAgICAgY3VzdG9tQ2xhc3Nlcz17dGhpcy5wcm9wcy5jdXN0b21DbGFzc2VzfVxuICAgICAgICBjdXN0b21MaXN0SXRlbUNvbXBvbmVudD17dGhpcy5wcm9wcy5jdXN0b21MaXN0SXRlbUNvbXBvbmVudH1cbiAgICAgICAgY3VzdG9tTGlzdEhlYWRlckNvbXBvbmVudD17dGhpcy5wcm9wcy5jdXN0b21MaXN0SGVhZGVyQ29tcG9uZW50fVxuICAgICAgICBzZWxlY3Rpb25JbmRleD17dGhpcy5zdGF0ZS5zZWxlY3Rpb25JbmRleH1cbiAgICAgICAgZGVmYXVsdENsYXNzTmFtZXM9e3RoaXMucHJvcHMuZGVmYXVsdENsYXNzTmFtZXN9XG4gICAgICAgIGRpc3BsYXlPcHRpb249e3RoaXMucHJvcHMuZGlzcGxheU9wdGlvbn1cbiAgICAgICAgc2VsZWN0ZWRJdGVtcz17dGhpcy5wcm9wcy5zZWxlY3RlZEl0ZW1zfVxuICAgICAgLz5cbiAgICApO1xuICB9XG5cbiAgZ2V0U2VsZWN0aW9uKCkge1xuICAgIGxldCBpbmRleCA9IHRoaXMuc3RhdGUuc2VsZWN0aW9uSW5kZXg7XG5cbiAgICBpZiAodGhpcy5faGFzQ3VzdG9tVmFsdWUoKSkge1xuICAgICAgaWYgKGluZGV4ID09PSAwKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN0YXRlLmVudHJ5VmFsdWU7XG4gICAgICB9XG4gICAgICBpbmRleC0tO1xuICAgIH1cbiAgICBpZiAodGhpcy5faGFzRml4ZWRPcHRpb25zKCkpIHtcbiAgICAgIHJldHVybiBpbmRleCA8IHRoaXMucHJvcHMuZml4ZWRPcHRpb25zLmxlbmd0aFxuICAgICAgICA/IHRoaXMucHJvcHMuZml4ZWRPcHRpb25zW2luZGV4XVxuICAgICAgICA6IHRoaXMuc3RhdGUuc2VhcmNoUmVzdWx0c1tpbmRleCAtIHRoaXMucHJvcHMuZml4ZWRPcHRpb25zLmxlbmd0aF07XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnN0YXRlLnNlYXJjaFJlc3VsdHNbaW5kZXhdO1xuICB9XG5cbiAgX29uT3B0aW9uU2VsZWN0ZWQgPSAob3B0aW9uLCBldmVudCkgPT4ge1xuICAgIGlmICh0aGlzLnByb3BzLnNlYXJjaGFibGUpIHtcbiAgICAgIC8vIHJlc2V0IGVudHJ5IGlucHV0XG4gICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgc2VhcmNoUmVzdWx0czogdGhpcy5nZXRPcHRpb25zRm9yVmFsdWUoJycsIHRoaXMucHJvcHMub3B0aW9ucyksXG4gICAgICAgIHNlbGVjdGlvbjogJycsXG4gICAgICAgIGVudHJ5VmFsdWU6ICcnXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5wcm9wcy5vbk9wdGlvblNlbGVjdGVkKG9wdGlvbiwgZXZlbnQpO1xuICB9O1xuXG4gIC8vIHVzZSAoKSA9PiB7fSB0byBhdm9pZCBiaW5kaW5nICd0aGlzJ1xuICBfb25UZXh0RW50cnlVcGRhdGVkID0gKCkgPT4ge1xuICAgIGlmICh0aGlzLnByb3BzLnNlYXJjaGFibGUpIHtcbiAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5lbnRyeS5jdXJyZW50LnZhbHVlO1xuXG4gICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgc2VhcmNoUmVzdWx0czogdGhpcy5nZXRPcHRpb25zRm9yVmFsdWUodmFsdWUsIHRoaXMucHJvcHMub3B0aW9ucyksXG4gICAgICAgIHNlbGVjdGlvbjogJycsXG4gICAgICAgIGVudHJ5VmFsdWU6IHZhbHVlXG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgX29uRW50ZXIgPSBldmVudCA9PiB7XG4gICAgY29uc3Qgc2VsZWN0aW9uID0gdGhpcy5nZXRTZWxlY3Rpb24oKTtcbiAgICBpZiAoIXNlbGVjdGlvbikge1xuICAgICAgcmV0dXJuIHRoaXMucHJvcHMub25LZXlEb3duKGV2ZW50KTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuX29uT3B0aW9uU2VsZWN0ZWQoc2VsZWN0aW9uLCBldmVudCk7XG4gIH07XG5cbiAgX29uRXNjYXBlKCkge1xuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgc2VsZWN0aW9uSW5kZXg6IG51bGxcbiAgICB9KTtcbiAgfVxuXG4gIF9vblRhYihldmVudCkge1xuICAgIGNvbnN0IHNlbGVjdGlvbiA9IHRoaXMuZ2V0U2VsZWN0aW9uKCk7XG4gICAgbGV0IG9wdGlvbiA9IHNlbGVjdGlvblxuICAgICAgPyBzZWxlY3Rpb25cbiAgICAgIDogdGhpcy5zdGF0ZS5zZWFyY2hSZXN1bHRzLmxlbmd0aCA+IDBcbiAgICAgICAgPyB0aGlzLnN0YXRlLnNlYXJjaFJlc3VsdHNbMF1cbiAgICAgICAgOiBudWxsO1xuXG4gICAgaWYgKG9wdGlvbiA9PT0gbnVsbCAmJiB0aGlzLl9oYXNDdXN0b21WYWx1ZSgpKSB7XG4gICAgICBvcHRpb24gPSB0aGlzLl9nZXRDdXN0b21WYWx1ZSgpO1xuICAgIH1cblxuICAgIGlmIChvcHRpb24gIT09IG51bGwpIHtcbiAgICAgIHJldHVybiB0aGlzLl9vbk9wdGlvblNlbGVjdGVkKG9wdGlvbiwgZXZlbnQpO1xuICAgIH1cbiAgfVxuXG4gIGV2ZW50TWFwKGV2ZW50KSB7XG4gICAgY29uc3QgZXZlbnRzID0ge307XG5cbiAgICBldmVudHNbS2V5RXZlbnQuRE9NX1ZLX1VQXSA9IHRoaXMubmF2VXA7XG4gICAgZXZlbnRzW0tleUV2ZW50LkRPTV9WS19ET1dOXSA9IHRoaXMubmF2RG93bjtcbiAgICBldmVudHNbS2V5RXZlbnQuRE9NX1ZLX1JFVFVSTl0gPSBldmVudHNbXG4gICAgICBLZXlFdmVudC5ET01fVktfRU5URVJcbiAgICBdID0gdGhpcy5fb25FbnRlcjtcbiAgICBldmVudHNbS2V5RXZlbnQuRE9NX1ZLX0VTQ0FQRV0gPSB0aGlzLl9vbkVzY2FwZTtcbiAgICBldmVudHNbS2V5RXZlbnQuRE9NX1ZLX1RBQl0gPSB0aGlzLl9vblRhYjtcblxuICAgIHJldHVybiBldmVudHM7XG4gIH1cblxuICBfbmF2KGRlbHRhKSB7XG4gICAgaWYgKCF0aGlzLl9oYXNIaW50KCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgbGV0IG5ld0luZGV4ID1cbiAgICAgIHRoaXMuc3RhdGUuc2VsZWN0aW9uSW5kZXggPT09IG51bGxcbiAgICAgICAgPyBkZWx0YSA9PT0gMSA/IDAgOiBkZWx0YVxuICAgICAgICA6IHRoaXMuc3RhdGUuc2VsZWN0aW9uSW5kZXggKyBkZWx0YTtcbiAgICBsZXQgbGVuZ3RoID0gdGhpcy5wcm9wcy5tYXhWaXNpYmxlXG4gICAgICA/IHRoaXMuc3RhdGUuc2VhcmNoUmVzdWx0cy5zbGljZSgwLCB0aGlzLnByb3BzLm1heFZpc2libGUpLmxlbmd0aFxuICAgICAgOiB0aGlzLnN0YXRlLnNlYXJjaFJlc3VsdHMubGVuZ3RoO1xuICAgIGlmICh0aGlzLl9oYXNDdXN0b21WYWx1ZSgpKSB7XG4gICAgICBsZW5ndGggKz0gMTtcbiAgICB9XG5cbiAgICBpZiAobmV3SW5kZXggPCAwKSB7XG4gICAgICBuZXdJbmRleCArPSBsZW5ndGg7XG4gICAgfSBlbHNlIGlmIChuZXdJbmRleCA+PSBsZW5ndGgpIHtcbiAgICAgIG5ld0luZGV4IC09IGxlbmd0aDtcbiAgICB9XG5cbiAgICB0aGlzLnNldFN0YXRlKHtzZWxlY3Rpb25JbmRleDogbmV3SW5kZXh9KTtcbiAgfVxuXG4gIG5hdkRvd24gPSAoKSA9PiB7XG4gICAgdGhpcy5fbmF2KDEpO1xuICB9O1xuXG4gIG5hdlVwID0gKCkgPT4ge1xuICAgIHRoaXMuX25hdigtMSk7XG4gIH07XG5cbiAgX29uQ2hhbmdlID0gZXZlbnQgPT4ge1xuICAgIGlmICh0aGlzLnByb3BzLm9uQ2hhbmdlKSB7XG4gICAgICB0aGlzLnByb3BzLm9uQ2hhbmdlKGV2ZW50KTtcbiAgICB9XG5cbiAgICB0aGlzLl9vblRleHRFbnRyeVVwZGF0ZWQoKTtcbiAgfTtcblxuICBfb25LZXlEb3duID0gZXZlbnQgPT4ge1xuICAgIC8vIElmIHRoZXJlIGFyZSBubyB2aXNpYmxlIGVsZW1lbnRzLCBkb24ndCBwZXJmb3JtIHNlbGVjdG9yIG5hdmlnYXRpb24uXG4gICAgLy8gSnVzdCBwYXNzIHRoaXMgdXAgdG8gdGhlIHVwc3RyZWFtIG9uS2V5ZG93biBoYW5kbGVyLlxuICAgIC8vIEFsc28gc2tpcCBpZiB0aGUgdXNlciBpcyBwcmVzc2luZyB0aGUgc2hpZnQga2V5LCBzaW5jZSBub25lIG9mIG91ciBoYW5kbGVycyBhcmUgbG9va2luZyBmb3Igc2hpZnRcbiAgICBpZiAoIXRoaXMuX2hhc0hpbnQoKSB8fCBldmVudC5zaGlmdEtleSkge1xuICAgICAgcmV0dXJuIHRoaXMucHJvcHMub25LZXlEb3duKGV2ZW50KTtcbiAgICB9XG5cbiAgICBjb25zdCBoYW5kbGVyID0gdGhpcy5ldmVudE1hcCgpW2V2ZW50LmtleUNvZGVdO1xuXG4gICAgaWYgKGhhbmRsZXIpIHtcbiAgICAgIGhhbmRsZXIoZXZlbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5wcm9wcy5vbktleURvd24oZXZlbnQpO1xuICAgIH1cbiAgICAvLyBEb24ndCBwcm9wYWdhdGUgdGhlIGtleXN0cm9rZSBiYWNrIHRvIHRoZSBET00vYnJvd3NlclxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gIH07XG5cbiAgX29uRm9jdXMgPSBldmVudCA9PiB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7aXNGb2N1c2VkOiB0cnVlfSk7XG4gICAgaWYgKHRoaXMucHJvcHMub25Gb2N1cykge1xuICAgICAgcmV0dXJuIHRoaXMucHJvcHMub25Gb2N1cyhldmVudCk7XG4gICAgfVxuICB9O1xuXG4gIF9vbkJsdXIgPSBldmVudCA9PiB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7aXNGb2N1c2VkOiBmYWxzZX0pO1xuICAgIGlmICh0aGlzLnByb3BzLm9uQmx1cikge1xuICAgICAgcmV0dXJuIHRoaXMucHJvcHMub25CbHVyKGV2ZW50KTtcbiAgICB9XG4gIH07XG5cbiAgX3JlbmRlckhpZGRlbklucHV0KCkge1xuICAgIGlmICghdGhpcy5wcm9wcy5uYW1lKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICByZXR1cm4gKFxuICAgICAgPGlucHV0XG4gICAgICAgIHR5cGU9XCJoaWRkZW5cIlxuICAgICAgICBuYW1lPXt0aGlzLnByb3BzLm5hbWV9XG4gICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLnNlbGVjdGlvbn1cbiAgICAgIC8+XG4gICAgKTtcbiAgfVxuXG4gIF9nZW5lcmF0ZVNlYXJjaEZ1bmN0aW9uKCkge1xuICAgIGNvbnN0IHNlYXJjaE9wdGlvbnNQcm9wID0gdGhpcy5wcm9wcy5zZWFyY2hPcHRpb25zO1xuICAgIGNvbnN0IGZpbHRlck9wdGlvblByb3AgPSB0aGlzLnByb3BzLmZpbHRlck9wdGlvbjtcbiAgICBpZiAodHlwZW9mIHNlYXJjaE9wdGlvbnNQcm9wID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBpZiAoZmlsdGVyT3B0aW9uUHJvcCAhPT0gbnVsbCkge1xuICAgICAgICBDb25zb2xlLndhcm4oXG4gICAgICAgICAgJ3NlYXJjaE9wdGlvbnMgcHJvcCBpcyBiZWluZyB1c2VkLCBmaWx0ZXJPcHRpb24gcHJvcCB3aWxsIGJlIGlnbm9yZWQnXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICByZXR1cm4gc2VhcmNoT3B0aW9uc1Byb3A7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZmlsdGVyT3B0aW9uUHJvcCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgLy8gdXNlIGN1c3RvbSBmaWx0ZXIgb3B0aW9uXG4gICAgICByZXR1cm4gKHZhbHVlLCBvcHRpb25zKSA9PlxuICAgICAgICBvcHRpb25zLmZpbHRlcihvID0+IGZpbHRlck9wdGlvblByb3AodmFsdWUsIG8pKTtcbiAgICB9XG5cbiAgICBjb25zdCBtYXBwZXIgPVxuICAgICAgdHlwZW9mIGZpbHRlck9wdGlvblByb3AgPT09ICdzdHJpbmcnXG4gICAgICAgID8gQWNjZXNzb3IuZ2VuZXJhdGVBY2Nlc3NvcihmaWx0ZXJPcHRpb25Qcm9wKVxuICAgICAgICA6IEFjY2Vzc29yLklERU5USVRZX0ZOO1xuXG4gICAgcmV0dXJuICh2YWx1ZSwgb3B0aW9ucykgPT5cbiAgICAgIGZ1enp5XG4gICAgICAgIC5maWx0ZXIodmFsdWUsIG9wdGlvbnMsIHtleHRyYWN0OiBtYXBwZXJ9KVxuICAgICAgICAubWFwKHJlcyA9PiBvcHRpb25zW3Jlcy5pbmRleF0pO1xuICB9XG5cbiAgX2hhc0hpbnQoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3RhdGUuc2VhcmNoUmVzdWx0cy5sZW5ndGggPiAwIHx8IHRoaXMuX2hhc0N1c3RvbVZhbHVlKCk7XG4gIH1cblxuICBfaGFzRml4ZWRPcHRpb25zKCkge1xuICAgIHJldHVybiAoXG4gICAgICBBcnJheS5pc0FycmF5KHRoaXMucHJvcHMuZml4ZWRPcHRpb25zKSAmJiB0aGlzLnByb3BzLmZpeGVkT3B0aW9ucy5sZW5ndGhcbiAgICApO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IGlucHV0Q2xhc3NlcyA9IHt9O1xuICAgIGlucHV0Q2xhc3Nlc1t0aGlzLnByb3BzLmN1c3RvbUNsYXNzZXMuaW5wdXRdID0gQm9vbGVhbihcbiAgICAgIHRoaXMucHJvcHMuY3VzdG9tQ2xhc3Nlcy5pbnB1dFxuICAgICk7XG4gICAgY29uc3QgaW5wdXRDbGFzc0xpc3QgPSBjbGFzc05hbWVzKGlucHV0Q2xhc3Nlcyk7XG5cbiAgICBjb25zdCBjbGFzc2VzID0ge1xuICAgICAgW0RFRkFVTFRfQ0xBU1NdOiB0aGlzLnByb3BzLmRlZmF1bHRDbGFzc05hbWVzXG4gICAgfTtcbiAgICBjbGFzc2VzW3RoaXMucHJvcHMuY2xhc3NOYW1lXSA9IEJvb2xlYW4odGhpcy5wcm9wcy5jbGFzc05hbWUpO1xuICAgIGNvbnN0IGNsYXNzTGlzdCA9IGNsYXNzTmFtZXMoY2xhc3Nlcyk7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPFR5cGVhaGVhZFdyYXBwZXJcbiAgICAgICAgY2xhc3NOYW1lPXtjbGFzc0xpc3R9XG4gICAgICAgIHJlZj17dGhpcy5yb290fVxuICAgICAgICB0YWJJbmRleD1cIjBcIlxuICAgICAgICBvbktleURvd249e3RoaXMuX29uS2V5RG93bn1cbiAgICAgICAgb25LZXlQcmVzcz17dGhpcy5wcm9wcy5vbktleVByZXNzfVxuICAgICAgICBvbktleVVwPXt0aGlzLnByb3BzLm9uS2V5VXB9XG4gICAgICAgIG9uRm9jdXM9e3RoaXMuX29uRm9jdXN9XG4gICAgICA+XG4gICAgICAgIHt0aGlzLl9yZW5kZXJIaWRkZW5JbnB1dCgpfVxuICAgICAgICB7dGhpcy5wcm9wcy5zZWFyY2hhYmxlID8gKFxuICAgICAgICA8SW5wdXRCb3g+XG4gICAgICAgICAgPFR5cGVhaGVhZElucHV0XG4gICAgICAgICAgICByZWY9e3RoaXMuZW50cnl9XG4gICAgICAgICAgICB0eXBlPVwidGV4dFwiXG4gICAgICAgICAgICBkaXNhYmxlZD17dGhpcy5wcm9wcy5kaXNhYmxlZH1cbiAgICAgICAgICAgIHsuLi50aGlzLnByb3BzLmlucHV0UHJvcHN9XG4gICAgICAgICAgICBwbGFjZWhvbGRlcj17dGhpcy5wcm9wcy5wbGFjZWhvbGRlcn1cbiAgICAgICAgICAgIGNsYXNzTmFtZT17aW5wdXRDbGFzc0xpc3R9XG4gICAgICAgICAgICB2YWx1ZT17dGhpcy5zdGF0ZS5lbnRyeVZhbHVlfVxuICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuX29uQ2hhbmdlfVxuICAgICAgICAgICAgb25CbHVyPXt0aGlzLl9vbkJsdXJ9XG4gICAgICAgICAgLz5cbiAgICAgICAgICA8SW5wdXRJY29uPlxuICAgICAgICAgICAgPFNlYXJjaCBoZWlnaHQ9XCIxOHB4XCIvPlxuICAgICAgICAgIDwvSW5wdXRJY29uPlxuICAgICAgICA8L0lucHV0Qm94PlxuICAgICAgICApIDogbnVsbH1cbiAgICAgICAge3RoaXMuX3JlbmRlckluY3JlbWVudGFsU2VhcmNoUmVzdWx0cygpfVxuICAgICAgPC9UeXBlYWhlYWRXcmFwcGVyPlxuICAgICk7XG4gIH1cbn07XG4iXX0=